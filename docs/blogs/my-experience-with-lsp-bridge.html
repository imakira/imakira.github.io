<!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="utf-8" /><meta content="ie=edge" http-equiv="x-ua-compatible" /><meta content="The experience of using  lsp-mode  or  elgot  depends heavily on the lsp server you are using and the project you are working on. With the newly added JSON..." name="description" /><meta content="width=device-width, initial-scale=1" name="viewport" /><title>My Experience with lsp-bridge | Coruscation.net</title><link href="https://fonts.googleapis.com" rel="preconnect" /><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" /><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&amp;display=swap" rel="stylesheet" /><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&amp;icon_names=keyboard_arrow_down" rel="stylesheet" /><link href="/main.css?v=1767424738730" rel="stylesheet" /><link href="https://coruscation.net/atom.xml" rel="alternate" title="Coruscation.net" type="application/rss+xml" /><link href="/js/main.js" rel="modulepreload" /></head><body><div id="root"><div class="app h-dvh w-full xl:grid xl:grid-cols-[20rem_9fr]"><div class="transition-all"><div class="bg-opacity-100 px-4 relative bg-[#0260B3] sm:flex sm:justify-between block gap-4 xl:grid xl:grid-cols-[2fr_3fr] xl:h-dvh xl:fixed xl:w-[20rem]"><a class="flex justify-center block" href="/"><span class="text-3xl text-cyan-50 pt-4 sm:py-6 xl:sideways-lr xl:text-6xl xl:pb-8">Coruscation.net</span></a><div class="flex justify-center"><div class="flex flex-col items-center justify-end py-1 relative left-[0.275rem] sm:items-end xl:justify-between"><div class="navigator-bar gap-3 text-base text-slate-50 opacity-80 flex px-5 my-2 xl:text-2xl xl:flex-col xl:pt-6"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300 group-hover:bg-yellow-400"></div><div class="relative w-full h-full"><div class="px-1 group-hover:text-cyan-50 text-lg"><a href="/">HOME</a></div></div></div><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300 group-hover:bg-yellow-400"></div><div class="relative w-full h-full"><div class="px-1 group-hover:text-cyan-50 text-lg"><a href="https://github.com/imakira">ABOUT</a></div></div></div><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300 group-hover:bg-yellow-400"></div><div class="relative w-full h-full"><div class="px-1 group-hover:text-cyan-50 text-lg"><a href="https://github.com/imakira">PROJECTS</a></div></div></div></div><div class="justify-center w-full mb-8 relative hidden xl:flex"><div class="flex relative"><a href="/atom.xml"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="40" height="32">&lt;!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --&gt;<path d="M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zM96 136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm0 120a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path></svg></a><a href="https://github.com/imakira/cerulean"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" width="40" height="32">&lt;!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --&gt;<path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></div></div></div></div></div></div><main class="pt-5 px-2 sm:px-4 xl:pt-7 xl:px-8"><div class="px-4 relative"><div><h1 class="font-medium text-neutral-700 leading-tight text-2xl sm:text-[2rem]">My Experience with lsp-bridge</h1><hr class="border-t-1 border-slate-500 w-full my-3"/><div class="text-base grid items-center text-gray-700 pl-[1px] grid-cols-[7rem_1fr]"><div class="text-sky-700 border-l-2 pl-2 text-lg">Coding</div><span class="flex items-center gap-4"><span class="flex items-center gap-2"><span class="text-gray-600">Pub.</span><span class="text-base text-gray-700">Nov 22, 2025</span></span><span class="flex items-center gap-2"><span class="text-gray-600">Upd.</span><span class="text-base text-gray-700">Nov 25, 2025</span></span></span></div></div><div></div><input id="toc-mobile-control" class="hidden" type="checkbox"/><label class=" toc-header cursor-pointer select-none block text-sky-700 border-1 pl-2  flex justify-between items-center mt-3 bg-white sticky top-0 h-8 pr-1  md:hidden ml-[1px] relative " for="toc-mobile-control"><div class="relative h-full w-full overflow-hidden"><div class="text-lg toc-header-text relative  w-full transition-all "><div class="h-8 w-96">Table Of Content</div><div class="h-8 w-96 overflow-hidden">Basic Setup</div><div class="h-8 w-96 overflow-hidden">Configuration</div><div class="h-8 w-96 overflow-hidden">Keymapping</div><div class="h-8 w-96 overflow-hidden">a Little Hack (minimum popup width)</div><div class="h-8 w-96 overflow-hidden">flymake</div><div class="h-8 w-96 overflow-hidden">Workspace Management</div><div class="h-8 w-96 overflow-hidden">Working with Java</div><div class="h-8 w-96 overflow-hidden">Working with Clojure and Cider</div><div class="h-8 w-96 overflow-hidden">Conclusion</div></div></div><span class="material-symbols-outlined checked:rotate-180 transition-all dropdown-icon">keyboard_arrow_down</span></label><div class="toc-mobile-wrapper2 h-1 sticky top-8"><div class="grid toc-mobile-wrapper transition-all border-neutral-400 border-l-1 bg-white md:hidden ml-[1px] "><ul class="toc-mobile-content text-[1.05rem] 2xl:text-lg "><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#basic-setup"><span>Basic Setup</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#configuration"><span>Configuration</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-8" href="#keymapping"><span>Keymapping</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-8" href="#a-little-hack-(minimum-popup-width)"><span>a Little Hack (minimum popup width)</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-8" href="#flymake"><span>flymake</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#workspace-management"><span>Workspace Management</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#working-with-java"><span>Working with Java</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#working-with-clojure-and-cider"><span>Working with Clojure and Cider</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#conclusion"><span>Conclusion</span></a></div></div></div></li></ul></div></div><div class="gap-8 w-full h-full md:grid md:grid-cols-[minmax(0px,7fr)_minmax(17rem,17rem)] 2xl:grid-cols-[minmax(0px,7fr)_minmax(20rem,20rem)]"><div class="cr-document md:mt-1"><p>
The experience of using <code>lsp-mode</code> or <code>elgot</code> depends heavily on the lsp server you are using and the project you are working on. With the newly added JSON parser in Emacs 30 and the garbage collecting improvements in the <a href="https://github.com/emacs-mirror/emacs/blob/feature/igc/README-IGC">igc branch</a>, the experience of <code>lsp-mode</code> or <code>eglot</code> can be more than good enough. Still, if you are using the more demanding lsp server (like some language servers for frontend development) or working on a larger-size project, the experience could still be unsatisfying or even super frustrating. If you have ever experienced Emacs freezing after checkout to another git branch or big gc lag when using <code>gcmh-mode</code>, you could still consider giving <code>lsp-bridge</code> a try.
</p>

<p>
In exchange for speed and fluency, <code>lsp-bridge</code> replaces every builtin and well known tools that aren't suitable for async operations, including but not limited to <code>completion-at-point</code>, <code>xref</code>, <code>eldoc</code>. This prevents a lot of users from ever trying it, and that's reasonable. However, the async nature of <code>lsp-bridge</code> also brings its own advantages.
</p>

<p>
For a small example, consider that even the <code>go-to-definition</code> operation in <code>lsp-bridge</code> is asynchronous. With other lsp clients, Emacs is stuck between the time you call <code>xref-find-definitions</code> and the lsp server returns a response. With <code>lsp-bridge</code>, even if you are waiting for a response, Emacs is free to do other things in the meantime, such as doing a garbage collection, or executing a callback registered by <code>run-with-idle-timer</code>.
</p>

<p>
Finally, you certainly can use lsp-bridge only for some modes and keep using <code>completion-at-point</code> for other modes. That's also what I'm doing.
</p>
<div id="outline-container-basic-setup" class="outline-2">
<a href="#basic-setup"><h2 id="basic-setup" class="cr-self-reference ">Basic Setup</h2></a>
<div class="outline-text-2" id="text-basic-setup">
<p>
To use <code>lsp-bridge</code>, you first need to install some external dependencies.
</p>

<div class="org-src-container">
<pre class="cr-highlighted"><code class="lang-bash"><html><head></head><body>pip3 install epc orjson sexpdata six setuptools paramiko rapidfuzz watchdog packaging
</body></html></code></pre>
</div>

<p>
If you are using Nix, you need to add a python package with dependencies to your Nix config files.
</p>

<div class="org-src-container">
<pre class="cr-highlighted"><code class="lang-nix"><html><head></head><body>(python3.withPackages (
      <span class="hljs-params">ps:</span> <span class="hljs-keyword">with</span> ps; [
        <span class="hljs-comment"># ...</span>
        epc
        orjson
        packaging
        paramiko
        rapidfuzz
        setuptools
        sexpdata
        six
        watchdog
      ]
    ))
</body></html></code></pre>
</div>

<p>
With external dependencies installed, now we can install the <code>lsp-bridge</code> package. Here's how I have done it with <code>straight</code> and <code>use-package</code>.
</p>

<div class="org-src-container">
<pre class="cr-highlighted"><code class="lang-emacs-lisp"><html><head></head><body>(<span class="hljs-name">use-package</span> lsp-bridge
  <span class="hljs-symbol">:hook</span>
  (<span class="hljs-name">clojure-mode</span> . lsp-bridge-mode)
  (<span class="hljs-name">clojure-ts-mode</span> . lsp-bridge-mode)
  (<span class="hljs-name">typescript-ts-mode</span> . lsp-bridge-mode)
  (<span class="hljs-name">js-ts-mode</span> . lsp-bridge-mode)
  (<span class="hljs-name">java-ts-mode</span> . lsp-bridge-mode)
  <span class="hljs-symbol">:straight</span> '(lsp-bridge <span class="hljs-symbol">:type</span> git <span class="hljs-symbol">:host</span> github <span class="hljs-symbol">:repo</span> <span class="hljs-string">&quot;manateelazycat/lsp-bridge&quot;</span>
                         <span class="hljs-symbol">:files</span> (:defaults <span class="hljs-string">&quot;*.el&quot;</span> <span class="hljs-string">&quot;*.py&quot;</span> <span class="hljs-string">&quot;acm&quot;</span> <span class="hljs-string">&quot;core&quot;</span> <span class="hljs-string">&quot;langserver&quot;</span> <span class="hljs-string">&quot;multiserver&quot;</span> <span class="hljs-string">&quot;resources&quot;</span>)
                         <span class="hljs-symbol">:build</span> (:not compile))

  <span class="hljs-symbol">:init</span>
  (<span class="hljs-name">defun</span> me/lsp-bridge-corfu-hook ()
    (<span class="hljs-name">when</span> (<span class="hljs-name">and</span> lsp-bridge-mode
               (<span class="hljs-name">boundp</span> 'corfu-mode)
               corfu-mode)
      (<span class="hljs-name">corfu-mode</span> <span class="hljs-number">-1</span>)))
  (<span class="hljs-name">add-hook</span> 'corfu-mode-hook #'me/lsp-bridge-corfu-hook))
</body></html></code></pre>
</div>

<p>
Here I only enabled <code>lsp-bridge-mode</code> for modes in the <code>:hook</code> part, and I disabled <code>corfu</code> in <code>lsp-bridge-mode-hook</code> (I'm still using it for other programming or writing tasks).
</p>

<p>
Unlike <code>lsp-mode</code>, lsp-bridge doesn't provide a lsp server installation function. Check <a href="https://github.com/manateelazycat/lsp-bridge?tab=readme-ov-file#supported-language-servers">Supported language servers</a> and their corresponding pages for installation methods.
</p>

<p>
If the server is installed and <code>lsp-bridge-mode</code> is enabled, it should just work without any other configurations. If it doesn't, set <code>lsp-bridge-enable-debug</code> to true and check <code>*lsp-bridge*</code> for error messages.
</p>
</div>
</div>
<div id="outline-container-configuration" class="outline-2">
<a href="#configuration"><h2 id="configuration" class="cr-self-reference ">Configuration</h2></a>
<div class="outline-text-2" id="text-configuration">
</div>
<div id="outline-container-keymapping" class="outline-3">
<a href="#keymapping"><h3 id="keymapping" class="cr-self-reference ">Keymapping</h3></a>
<div class="outline-text-3" id="text-keymapping">
<p>
lsp-bridge provides its xef and eldoc equivalents, but it's up to us to mapping them. Here is what I do just for a reference.
</p>

<div class="org-src-container">
<pre class="cr-highlighted"><code class="lang-emacs-lisp"><html><head></head><body>(<span class="hljs-name">general-evil-define-key</span> '(normal) '(lsp-bridge-mode-map)
  <span class="hljs-string">&quot;s S&quot;</span> #'lsp-bridge-workspace-list-symbols
  <span class="hljs-string">&quot;s D&quot;</span> #'lsp-bridge-diagnostic-list
  <span class="hljs-string">&quot;s R&quot;</span> #'lsp-bridge-rename
  <span class="hljs-string">&quot;g d&quot;</span> #'lsp-bridge-find-def
  <span class="hljs-string">&quot;g r&quot;</span> #'lsp-bridge-find-references
  <span class="hljs-string">&quot;g D&quot;</span> #'lsp-bridge-find-impl
  <span class="hljs-string">&quot;C-RET&quot;</span> #'lsp-bridge-code-action
  <span class="hljs-string">&quot;C-&lt;return&gt;&quot;</span> #'lsp-bridge-code-action)
</body></html></code></pre>
</div>
</div>
</div>
<div id="outline-container-a-little-hack-(minimum-popup-width)" class="outline-3">
<a href="#a-little-hack-(minimum-popup-width)"><h3 id="a-little-hack-(minimum-popup-width)" class="cr-self-reference ">a Little Hack (minimum popup width)</h3></a>
<div class="outline-text-3" id="text-a-little-hack-(minimum-popup-width)">
<p>
In corfu you can set minimum popup width with <code>corfu-min-width</code>. <code>lsp-bridge~/~acm</code> currently doesn't provide a way to do so. However it is relatively easy to hack one.
</p>

<div class="org-src-container">
<pre class="cr-highlighted"><code class="lang-emacs-lisp"><html><head></head><body>(<span class="hljs-name">setq</span> me/acm-minimum-width <span class="hljs-number">1000</span>)

(<span class="hljs-name">defun</span> me/acm-minimum-width-function (<span class="hljs-name">oldfun</span> <span class="hljs-symbol">&amp;rest</span> r)
  (<span class="hljs-name">let</span> ((<span class="hljs-name">result</span> (<span class="hljs-name">apply</span> oldfun r)))
    (<span class="hljs-name">max</span> me/acm-minimum-width result)))

(<span class="hljs-name">advice-add</span> 'acm-menu-max-length <span class="hljs-symbol">:around</span> #'me/acm-minimum-width-function)
</body></html></code></pre>
</div>
</div>
</div>
<div id="outline-container-flymake" class="outline-3">
<a href="#flymake"><h3 id="flymake" class="cr-self-reference ">flymake</h3></a>
<div class="outline-text-3" id="text-flymake">
<p>
There is actually a third-party lsp-bridge integration for flymake. Check <a href="https://github.com/eki3z/flymake-bridge">eki3z/flymake-bridge</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-workspace-management" class="outline-2">
<a href="#workspace-management"><h2 id="workspace-management" class="cr-self-reference ">Workspace Management</h2></a>
<div class="outline-text-2" id="text-workspace-management">
<p>
lsp-bridge's workspace detection depends entirely on <code>git</code>. It simply use the nearest directory contains <code>.git</code> as the workspace root. This may not be enough for some use cases. However, it provides a <code>lsp-bridge-get-project-path-by-filepath</code> for us to customize. We can implement something similar to what lsp-mode provides fairly easily.
</p>

<div class="org-src-container">
<pre class="cr-highlighted"><code class="lang-emacs-lisp"><html><head></head><body>(<span class="hljs-name">require</span> 'f)

<span class="hljs-comment">;; assume savehist-mode is enabled</span>
(<span class="hljs-name">defvar</span> me/lsp-bridge-workspaces (<span class="hljs-name">list</span>))
(<span class="hljs-name">add-to-list</span> 'savehist-additional-variables 'me/lsp-bridge-workspaces)

(<span class="hljs-name">defun</span> me/lsp-bridge-workspace-add (<span class="hljs-name">project-root</span>)
  (<span class="hljs-name">interactive</span>
   (<span class="hljs-name">list</span> (<span class="hljs-name">read-directory-name</span> <span class="hljs-string">&quot;Select folder:&quot;</span>)))
  (<span class="hljs-name">add-to-list</span> 'me/lsp-bridge-workspaces project-root))

(<span class="hljs-name">defun</span> me/lsp-bridge-workspace-remove (<span class="hljs-name">project-root</span>)
  (<span class="hljs-name">interactive</span> (<span class="hljs-name">list</span> (<span class="hljs-name">completing-read</span> <span class="hljs-string">&quot;Select folder to remove: &quot;</span>
                                      me/lsp-bridge-workspaces)))
  (<span class="hljs-name">setq</span> me/lsp-bridge-workspaces (<span class="hljs-name">cl-remove</span> project-root me/lsp-bridge-workspaces <span class="hljs-symbol">:test</span> #'equal)))

(<span class="hljs-name">defun</span> me/lsp-bridge-get-workspace (<span class="hljs-name">path</span>)
  (<span class="hljs-name">cl-first</span> (<span class="hljs-name">cl-mapcar</span> #'f-expand
                       (<span class="hljs-name">cl-remove-if-not</span> (<span class="hljs-name">lambda</span> (<span class="hljs-name">workspace</span>)
                                           (<span class="hljs-name">if</span> (<span class="hljs-name">f-ancestor-of</span>? (<span class="hljs-name">f-expand</span> workspace) path)
                                                   workspace                                  
                                             <span class="hljs-literal">nil</span>))
                                         me/lsp-bridge-workspaces))))

(<span class="hljs-name">setq</span> lsp-bridge-get-project-path-by-filepath #'me/lsp-bridge-get-workspace)
</body></html></code></pre>
</div>
</div>
</div>
<div id="outline-container-working-with-java" class="outline-2">
<a href="#working-with-java"><h2 id="working-with-java" class="cr-self-reference ">Working with Java</h2></a>
<div class="outline-text-2" id="text-working-with-java">
<p>
We need a few more lines of configuration to make it works with Java.
</p>

<div class="org-src-container">
<pre class="cr-highlighted"><code class="lang-emacs-lisp"><html><head></head><body>(<span class="hljs-name">use-package</span> lsp-bridge
  <span class="hljs-comment">;; ...</span>
  <span class="hljs-symbol">:init</span>
  (<span class="hljs-name">require</span> 'lsp-bridge-jdtls)
  (<span class="hljs-name">setq</span> lsp-bridge-enable-auto-import <span class="hljs-literal">t</span>)
  <span class="hljs-comment">;; ... other configurations</span>
  )
</body></html></code></pre>
</div>
</div>
</div>
<div id="outline-container-working-with-clojure-and-cider" class="outline-2">
<a href="#working-with-clojure-and-cider"><h2 id="working-with-clojure-and-cider" class="cr-self-reference ">Working with Clojure and Cider</h2></a>
<div class="outline-text-2" id="text-working-with-clojure-and-cider">
<p>
When writing Clojure, I would like to use <code>cider</code> for completion and let lsp handling everything else. With <code>lsp-mode</code> we can just locally set <code>lsp-enable-completion-at-point</code> to false. With <code>lsp-bridge</code>, well, we can disable <code>lsp-bridge</code>'s automatic popup and continue to use corfu.
</p>

<div class="org-src-container">
<pre class="cr-highlighted"><code class="lang-emacs-lisp"><html><head></head><body>(<span class="hljs-name">use-package</span> lsp-bridge
  <span class="hljs-comment">;; ...</span>
  <span class="hljs-comment">;; add a new variable</span>
  (<span class="hljs-name">defvar</span> me/force-corfu <span class="hljs-literal">nil</span>)

  <span class="hljs-comment">;; change the previous hook to this</span>
  (<span class="hljs-name">defun</span> me/lsp-bridge-corfu-hook ()
    (<span class="hljs-name">when</span> (<span class="hljs-name">and</span> lsp-bridge-mode
               (<span class="hljs-name">boundp</span> 'corfu-mode)
               corfu-mode
               (<span class="hljs-name">not</span> me/force-corfu))
      (<span class="hljs-name">corfu-mode</span> <span class="hljs-number">-1</span>))))

(<span class="hljs-name">use-package</span> cider
  <span class="hljs-symbol">:after</span> lsp-bridge
  <span class="hljs-symbol">:config</span>
  (<span class="hljs-name">defun</span> me/lsp-bridge-cider-hook ()
    (<span class="hljs-name">when</span> cider-mode
      (<span class="hljs-name">setq-local</span> me/force-corfu <span class="hljs-literal">t</span>)
      (<span class="hljs-name">setq-local</span> lsp-bridge-complete-manually <span class="hljs-literal">t</span>)
      (<span class="hljs-name">corfu-mode</span> <span class="hljs-number">1</span>)))
  (<span class="hljs-name">add-hook</span> 'cider-mode-hook #'me/lsp-bridge-cider-hook <span class="hljs-number">80</span>))
</body></html></code></pre>
</div>
</div>
</div>
<div id="outline-container-conclusion" class="outline-2">
<a href="#conclusion"><h2 id="conclusion" class="cr-self-reference ">Conclusion</h2></a>
<div class="outline-text-2" id="text-conclusion">
<p>
Overall I would say I'm satisfied with what lsp-bridge provides and amazed at its fluency. I can now load and browse through <a href="https://github.com/oracle/graaljs.git">graaljs</a>'s source code with no stutter, no random freeze I need to <code>C-g</code>, that may or may not work, no nothing. The strategy of off-loading computation to an external process and async everything seems to put very light weight on the Emacs side and work really well.
</p>
</div>
</div>
</div><div class="mt-4"><div class="border-neutral-400 border-l-2 text-[1.05rem] 2xl:text-lg w-78 fixed right-0 top-[13.5rem] z-200 max-h-[80vh] overflow-y-auto select-none hidden md:block xl:top-36  2xl:w-96"><ul><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#basic-setup"><span>Basic Setup</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#configuration"><span>Configuration</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-8" href="#keymapping"><span>Keymapping</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-8" href="#a-little-hack-(minimum-popup-width)"><span>a Little Hack (minimum popup width)</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-8" href="#flymake"><span>flymake</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#workspace-management"><span>Workspace Management</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#working-with-java"><span>Working with Java</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#working-with-clojure-and-cider"><span>Working with Clojure and Cider</span></a></div></div></div></li><li class="my-1 list-inside text-neutral-600"><div class="relative group"><div class="absolute w-0 h-full group-hover:bg-sky-200 group-hover:bg-opacity-70 group-hover:w-full group-hover:h-full transition-all duration-300"></div><div class="relative w-full h-full"><div class="group w-full h-full"><a class="h-12 transition-all w-full h-full inline-block flex flex-col justify-center group-hover:text-[#0260B3] pl-4" href="#conclusion"><span>Conclusion</span></a></div></div></div></li></ul></div></div></div></div></main></div></div><script>window.__server_path = "/"</script><script>window.__cerulean_rehydrate = true;</script><script>globalThis["blog/my-experience-with-lsp-bridge"] = {"blog/orgx":false,"blog/tags":[],"blog/unlisted":false,"blog/title":"My Experience with lsp-bridge","blog/show-toc?":true,"blog/file-path":"/home/void/Projects/imakira.github.io/blogs/my-experiment-with-lsp-bridge.org","blog/author":null,"blog/email":null,"blog/description":"The experience of using  lsp-mode  or  elgot  depends heavily on the lsp server you are using and the project you are working on. With the newly added JSON...","blog/id":"my-experience-with-lsp-bridge","blog/category":"Coding","blog/language":"en_US","blog/published-date":"2025-11-22T23:33:09+08:00","blog/content":"<p>\nThe experience of using <code>lsp-mode</code> or <code>elgot</code> depends heavily on the lsp server you are using and the project you are working on. With the newly added JSON parser in Emacs 30 and the garbage collecting improvements in the <a href=\"https://github.com/emacs-mirror/emacs/blob/feature/igc/README-IGC\">igc branch</a>, the experience of <code>lsp-mode</code> or <code>eglot</code> can be more than good enough. Still, if you are using the more demanding lsp server (like some language servers for frontend development) or working on a larger-size project, the experience could still be unsatisfying or even super frustrating. If you have ever experienced Emacs freezing after checkout to another git branch or big gc lag when using <code>gcmh-mode</code>, you could still consider giving <code>lsp-bridge</code> a try.\n</p>\n\n<p>\nIn exchange for speed and fluency, <code>lsp-bridge</code> replaces every builtin and well known tools that aren't suitable for async operations, including but not limited to <code>completion-at-point</code>, <code>xref</code>, <code>eldoc</code>. This prevents a lot of users from ever trying it, and that's reasonable. However, the async nature of <code>lsp-bridge</code> also brings its own advantages.\n</p>\n\n<p>\nFor a small example, consider that even the <code>go-to-definition</code> operation in <code>lsp-bridge</code> is asynchronous. With other lsp clients, Emacs is stuck between the time you call <code>xref-find-definitions</code> and the lsp server returns a response. With <code>lsp-bridge</code>, even if you are waiting for a response, Emacs is free to do other things in the meantime, such as doing a garbage collection, or executing a callback registered by <code>run-with-idle-timer</code>.\n</p>\n\n<p>\nFinally, you certainly can use lsp-bridge only for some modes and keep using <code>completion-at-point</code> for other modes. That's also what I'm doing.\n</p>\n<div id=\"outline-container-basic-setup\" class=\"outline-2\">\n<a href=\"#basic-setup\"><h2 id=\"basic-setup\" class=\"cr-self-reference \">Basic Setup</h2></a>\n<div class=\"outline-text-2\" id=\"text-basic-setup\">\n<p>\nTo use <code>lsp-bridge</code>, you first need to install some external dependencies.\n</p>\n\n<div class=\"org-src-container\">\n<pre class=\"cr-highlighted\"><code class=\"lang-bash\"><html><head></head><body>pip3 install epc orjson sexpdata six setuptools paramiko rapidfuzz watchdog packaging\n</body></html></code></pre>\n</div>\n\n<p>\nIf you are using Nix, you need to add a python package with dependencies to your Nix config files.\n</p>\n\n<div class=\"org-src-container\">\n<pre class=\"cr-highlighted\"><code class=\"lang-nix\"><html><head></head><body>(python3.withPackages (\n      <span class=\"hljs-params\">ps:</span> <span class=\"hljs-keyword\">with</span> ps; [\n        <span class=\"hljs-comment\"># ...</span>\n        epc\n        orjson\n        packaging\n        paramiko\n        rapidfuzz\n        setuptools\n        sexpdata\n        six\n        watchdog\n      ]\n    ))\n</body></html></code></pre>\n</div>\n\n<p>\nWith external dependencies installed, now we can install the <code>lsp-bridge</code> package. Here's how I have done it with <code>straight</code> and <code>use-package</code>.\n</p>\n\n<div class=\"org-src-container\">\n<pre class=\"cr-highlighted\"><code class=\"lang-emacs-lisp\"><html><head></head><body>(<span class=\"hljs-name\">use-package</span> lsp-bridge\n  <span class=\"hljs-symbol\">:hook</span>\n  (<span class=\"hljs-name\">clojure-mode</span> . lsp-bridge-mode)\n  (<span class=\"hljs-name\">clojure-ts-mode</span> . lsp-bridge-mode)\n  (<span class=\"hljs-name\">typescript-ts-mode</span> . lsp-bridge-mode)\n  (<span class=\"hljs-name\">js-ts-mode</span> . lsp-bridge-mode)\n  (<span class=\"hljs-name\">java-ts-mode</span> . lsp-bridge-mode)\n  <span class=\"hljs-symbol\">:straight</span> '(lsp-bridge <span class=\"hljs-symbol\">:type</span> git <span class=\"hljs-symbol\">:host</span> github <span class=\"hljs-symbol\">:repo</span> <span class=\"hljs-string\">&quot;manateelazycat/lsp-bridge&quot;</span>\n                         <span class=\"hljs-symbol\">:files</span> (:defaults <span class=\"hljs-string\">&quot;*.el&quot;</span> <span class=\"hljs-string\">&quot;*.py&quot;</span> <span class=\"hljs-string\">&quot;acm&quot;</span> <span class=\"hljs-string\">&quot;core&quot;</span> <span class=\"hljs-string\">&quot;langserver&quot;</span> <span class=\"hljs-string\">&quot;multiserver&quot;</span> <span class=\"hljs-string\">&quot;resources&quot;</span>)\n                         <span class=\"hljs-symbol\">:build</span> (:not compile))\n\n  <span class=\"hljs-symbol\">:init</span>\n  (<span class=\"hljs-name\">defun</span> me/lsp-bridge-corfu-hook ()\n    (<span class=\"hljs-name\">when</span> (<span class=\"hljs-name\">and</span> lsp-bridge-mode\n               (<span class=\"hljs-name\">boundp</span> 'corfu-mode)\n               corfu-mode)\n      (<span class=\"hljs-name\">corfu-mode</span> <span class=\"hljs-number\">-1</span>)))\n  (<span class=\"hljs-name\">add-hook</span> 'corfu-mode-hook #'me/lsp-bridge-corfu-hook))\n</body></html></code></pre>\n</div>\n\n<p>\nHere I only enabled <code>lsp-bridge-mode</code> for modes in the <code>:hook</code> part, and I disabled <code>corfu</code> in <code>lsp-bridge-mode-hook</code> (I'm still using it for other programming or writing tasks).\n</p>\n\n<p>\nUnlike <code>lsp-mode</code>, lsp-bridge doesn't provide a lsp server installation function. Check <a href=\"https://github.com/manateelazycat/lsp-bridge?tab=readme-ov-file#supported-language-servers\">Supported language servers</a> and their corresponding pages for installation methods.\n</p>\n\n<p>\nIf the server is installed and <code>lsp-bridge-mode</code> is enabled, it should just work without any other configurations. If it doesn't, set <code>lsp-bridge-enable-debug</code> to true and check <code>*lsp-bridge*</code> for error messages.\n</p>\n</div>\n</div>\n<div id=\"outline-container-configuration\" class=\"outline-2\">\n<a href=\"#configuration\"><h2 id=\"configuration\" class=\"cr-self-reference \">Configuration</h2></a>\n<div class=\"outline-text-2\" id=\"text-configuration\">\n</div>\n<div id=\"outline-container-keymapping\" class=\"outline-3\">\n<a href=\"#keymapping\"><h3 id=\"keymapping\" class=\"cr-self-reference \">Keymapping</h3></a>\n<div class=\"outline-text-3\" id=\"text-keymapping\">\n<p>\nlsp-bridge provides its xef and eldoc equivalents, but it's up to us to mapping them. Here is what I do just for a reference.\n</p>\n\n<div class=\"org-src-container\">\n<pre class=\"cr-highlighted\"><code class=\"lang-emacs-lisp\"><html><head></head><body>(<span class=\"hljs-name\">general-evil-define-key</span> '(normal) '(lsp-bridge-mode-map)\n  <span class=\"hljs-string\">&quot;s S&quot;</span> #'lsp-bridge-workspace-list-symbols\n  <span class=\"hljs-string\">&quot;s D&quot;</span> #'lsp-bridge-diagnostic-list\n  <span class=\"hljs-string\">&quot;s R&quot;</span> #'lsp-bridge-rename\n  <span class=\"hljs-string\">&quot;g d&quot;</span> #'lsp-bridge-find-def\n  <span class=\"hljs-string\">&quot;g r&quot;</span> #'lsp-bridge-find-references\n  <span class=\"hljs-string\">&quot;g D&quot;</span> #'lsp-bridge-find-impl\n  <span class=\"hljs-string\">&quot;C-RET&quot;</span> #'lsp-bridge-code-action\n  <span class=\"hljs-string\">&quot;C-&lt;return&gt;&quot;</span> #'lsp-bridge-code-action)\n</body></html></code></pre>\n</div>\n</div>\n</div>\n<div id=\"outline-container-a-little-hack-(minimum-popup-width)\" class=\"outline-3\">\n<a href=\"#a-little-hack-(minimum-popup-width)\"><h3 id=\"a-little-hack-(minimum-popup-width)\" class=\"cr-self-reference \">a Little Hack (minimum popup width)</h3></a>\n<div class=\"outline-text-3\" id=\"text-a-little-hack-(minimum-popup-width)\">\n<p>\nIn corfu you can set minimum popup width with <code>corfu-min-width</code>. <code>lsp-bridge~/~acm</code> currently doesn't provide a way to do so. However it is relatively easy to hack one.\n</p>\n\n<div class=\"org-src-container\">\n<pre class=\"cr-highlighted\"><code class=\"lang-emacs-lisp\"><html><head></head><body>(<span class=\"hljs-name\">setq</span> me/acm-minimum-width <span class=\"hljs-number\">1000</span>)\n\n(<span class=\"hljs-name\">defun</span> me/acm-minimum-width-function (<span class=\"hljs-name\">oldfun</span> <span class=\"hljs-symbol\">&amp;rest</span> r)\n  (<span class=\"hljs-name\">let</span> ((<span class=\"hljs-name\">result</span> (<span class=\"hljs-name\">apply</span> oldfun r)))\n    (<span class=\"hljs-name\">max</span> me/acm-minimum-width result)))\n\n(<span class=\"hljs-name\">advice-add</span> 'acm-menu-max-length <span class=\"hljs-symbol\">:around</span> #'me/acm-minimum-width-function)\n</body></html></code></pre>\n</div>\n</div>\n</div>\n<div id=\"outline-container-flymake\" class=\"outline-3\">\n<a href=\"#flymake\"><h3 id=\"flymake\" class=\"cr-self-reference \">flymake</h3></a>\n<div class=\"outline-text-3\" id=\"text-flymake\">\n<p>\nThere is actually a third-party lsp-bridge integration for flymake. Check <a href=\"https://github.com/eki3z/flymake-bridge\">eki3z/flymake-bridge</a>.\n</p>\n</div>\n</div>\n</div>\n<div id=\"outline-container-workspace-management\" class=\"outline-2\">\n<a href=\"#workspace-management\"><h2 id=\"workspace-management\" class=\"cr-self-reference \">Workspace Management</h2></a>\n<div class=\"outline-text-2\" id=\"text-workspace-management\">\n<p>\nlsp-bridge's workspace detection depends entirely on <code>git</code>. It simply use the nearest directory contains <code>.git</code> as the workspace root. This may not be enough for some use cases. However, it provides a <code>lsp-bridge-get-project-path-by-filepath</code> for us to customize. We can implement something similar to what lsp-mode provides fairly easily.\n</p>\n\n<div class=\"org-src-container\">\n<pre class=\"cr-highlighted\"><code class=\"lang-emacs-lisp\"><html><head></head><body>(<span class=\"hljs-name\">require</span> 'f)\n\n<span class=\"hljs-comment\">;; assume savehist-mode is enabled</span>\n(<span class=\"hljs-name\">defvar</span> me/lsp-bridge-workspaces (<span class=\"hljs-name\">list</span>))\n(<span class=\"hljs-name\">add-to-list</span> 'savehist-additional-variables 'me/lsp-bridge-workspaces)\n\n(<span class=\"hljs-name\">defun</span> me/lsp-bridge-workspace-add (<span class=\"hljs-name\">project-root</span>)\n  (<span class=\"hljs-name\">interactive</span>\n   (<span class=\"hljs-name\">list</span> (<span class=\"hljs-name\">read-directory-name</span> <span class=\"hljs-string\">&quot;Select folder:&quot;</span>)))\n  (<span class=\"hljs-name\">add-to-list</span> 'me/lsp-bridge-workspaces project-root))\n\n(<span class=\"hljs-name\">defun</span> me/lsp-bridge-workspace-remove (<span class=\"hljs-name\">project-root</span>)\n  (<span class=\"hljs-name\">interactive</span> (<span class=\"hljs-name\">list</span> (<span class=\"hljs-name\">completing-read</span> <span class=\"hljs-string\">&quot;Select folder to remove: &quot;</span>\n                                      me/lsp-bridge-workspaces)))\n  (<span class=\"hljs-name\">setq</span> me/lsp-bridge-workspaces (<span class=\"hljs-name\">cl-remove</span> project-root me/lsp-bridge-workspaces <span class=\"hljs-symbol\">:test</span> #'equal)))\n\n(<span class=\"hljs-name\">defun</span> me/lsp-bridge-get-workspace (<span class=\"hljs-name\">path</span>)\n  (<span class=\"hljs-name\">cl-first</span> (<span class=\"hljs-name\">cl-mapcar</span> #'f-expand\n                       (<span class=\"hljs-name\">cl-remove-if-not</span> (<span class=\"hljs-name\">lambda</span> (<span class=\"hljs-name\">workspace</span>)\n                                           (<span class=\"hljs-name\">if</span> (<span class=\"hljs-name\">f-ancestor-of</span>? (<span class=\"hljs-name\">f-expand</span> workspace) path)\n                                                   workspace                                  \n                                             <span class=\"hljs-literal\">nil</span>))\n                                         me/lsp-bridge-workspaces))))\n\n(<span class=\"hljs-name\">setq</span> lsp-bridge-get-project-path-by-filepath #'me/lsp-bridge-get-workspace)\n</body></html></code></pre>\n</div>\n</div>\n</div>\n<div id=\"outline-container-working-with-java\" class=\"outline-2\">\n<a href=\"#working-with-java\"><h2 id=\"working-with-java\" class=\"cr-self-reference \">Working with Java</h2></a>\n<div class=\"outline-text-2\" id=\"text-working-with-java\">\n<p>\nWe need a few more lines of configuration to make it works with Java.\n</p>\n\n<div class=\"org-src-container\">\n<pre class=\"cr-highlighted\"><code class=\"lang-emacs-lisp\"><html><head></head><body>(<span class=\"hljs-name\">use-package</span> lsp-bridge\n  <span class=\"hljs-comment\">;; ...</span>\n  <span class=\"hljs-symbol\">:init</span>\n  (<span class=\"hljs-name\">require</span> 'lsp-bridge-jdtls)\n  (<span class=\"hljs-name\">setq</span> lsp-bridge-enable-auto-import <span class=\"hljs-literal\">t</span>)\n  <span class=\"hljs-comment\">;; ... other configurations</span>\n  )\n</body></html></code></pre>\n</div>\n</div>\n</div>\n<div id=\"outline-container-working-with-clojure-and-cider\" class=\"outline-2\">\n<a href=\"#working-with-clojure-and-cider\"><h2 id=\"working-with-clojure-and-cider\" class=\"cr-self-reference \">Working with Clojure and Cider</h2></a>\n<div class=\"outline-text-2\" id=\"text-working-with-clojure-and-cider\">\n<p>\nWhen writing Clojure, I would like to use <code>cider</code> for completion and let lsp handling everything else. With <code>lsp-mode</code> we can just locally set <code>lsp-enable-completion-at-point</code> to false. With <code>lsp-bridge</code>, well, we can disable <code>lsp-bridge</code>'s automatic popup and continue to use corfu.\n</p>\n\n<div class=\"org-src-container\">\n<pre class=\"cr-highlighted\"><code class=\"lang-emacs-lisp\"><html><head></head><body>(<span class=\"hljs-name\">use-package</span> lsp-bridge\n  <span class=\"hljs-comment\">;; ...</span>\n  <span class=\"hljs-comment\">;; add a new variable</span>\n  (<span class=\"hljs-name\">defvar</span> me/force-corfu <span class=\"hljs-literal\">nil</span>)\n\n  <span class=\"hljs-comment\">;; change the previous hook to this</span>\n  (<span class=\"hljs-name\">defun</span> me/lsp-bridge-corfu-hook ()\n    (<span class=\"hljs-name\">when</span> (<span class=\"hljs-name\">and</span> lsp-bridge-mode\n               (<span class=\"hljs-name\">boundp</span> 'corfu-mode)\n               corfu-mode\n               (<span class=\"hljs-name\">not</span> me/force-corfu))\n      (<span class=\"hljs-name\">corfu-mode</span> <span class=\"hljs-number\">-1</span>))))\n\n(<span class=\"hljs-name\">use-package</span> cider\n  <span class=\"hljs-symbol\">:after</span> lsp-bridge\n  <span class=\"hljs-symbol\">:config</span>\n  (<span class=\"hljs-name\">defun</span> me/lsp-bridge-cider-hook ()\n    (<span class=\"hljs-name\">when</span> cider-mode\n      (<span class=\"hljs-name\">setq-local</span> me/force-corfu <span class=\"hljs-literal\">t</span>)\n      (<span class=\"hljs-name\">setq-local</span> lsp-bridge-complete-manually <span class=\"hljs-literal\">t</span>)\n      (<span class=\"hljs-name\">corfu-mode</span> <span class=\"hljs-number\">1</span>)))\n  (<span class=\"hljs-name\">add-hook</span> 'cider-mode-hook #'me/lsp-bridge-cider-hook <span class=\"hljs-number\">80</span>))\n</body></html></code></pre>\n</div>\n</div>\n</div>\n<div id=\"outline-container-conclusion\" class=\"outline-2\">\n<a href=\"#conclusion\"><h2 id=\"conclusion\" class=\"cr-self-reference \">Conclusion</h2></a>\n<div class=\"outline-text-2\" id=\"text-conclusion\">\n<p>\nOverall I would say I'm satisfied with what lsp-bridge provides and amazed at its fluency. I can now load and browse through <a href=\"https://github.com/oracle/graaljs.git\">graaljs</a>'s source code with no stutter, no random freeze I need to <code>C-g</code>, that may or may not work, no nothing. The strategy of off-loading computation to an external process and async everything seems to put very light weight on the Emacs side and work really well.\n</p>\n</div>\n</div>\n","blog/orgx-require":null,"blog/modified-date":"2025-11-25T16:23:27+08:00"};</script><script defer="defer" src="/js/main.js" type="module"></script></body></html>