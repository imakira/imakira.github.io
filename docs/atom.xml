<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>Coruscation.net</title>
  <link href="https://coruscation.net"/>
  <updated>2025-11-03T17:23:59+08:00</updated>
  <author>imakira</author>
  <id>https://coruscation.net</id>
  <entry>
    <title type="html">Build a ClojureScript Application Running on Node Using Nix</title>
    <link href="https://coruscation.net/blogs/build-a-clojurescript-application-running-on-node-using-nix.html"/>
    <updated>2025-11-03T17:23:59+08:00</updated>
    <id>https://coruscation.net/blogs/build-a-clojurescript-application-running-on-node-using-nix.html</id>
    <content type="html">&lt;p&gt;
To build a ClojureScript application, we need to pull dependencies from two package managers. That is, JavaScript packages from &lt;code&gt;npm&lt;/code&gt; and Clojure packages from &lt;code&gt;deps.edn&lt;/code&gt;. After pulling the dependencies, we can then let &lt;code&gt;shadow-cljs&lt;/code&gt; compiles the ClojureScript files into a single javascript and make the result a npm package. In this post, we rely on &lt;code&gt;nixpkgs&lt;/code&gt;'s builtin &lt;code&gt;fetchNpmDeps&lt;/code&gt; and &lt;code&gt;buildNpmPackage&lt;/code&gt; for the npm side, and &lt;a href="https://github.com/jlesquembre/clj-nix"&gt;clj-nix&lt;/a&gt; for the nix side.
&lt;/p&gt;
&lt;div id="outline-container-orga8fc909" class="outline-2"&gt;
&lt;a href="#orga8fc909"&gt;&lt;h2 id="orga8fc909" class="cr-self-reference "&gt;Prerequisites&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-orga8fc909"&gt;
&lt;p&gt;
I will skip the details that are not unique to Nix. The following contents assume we already have a working shadow-cljs project that can produce a node.js target when running &lt;code&gt;npm run release&lt;/code&gt;. Which is basically:
&lt;/p&gt;

&lt;ul class="org-ul"&gt;
&lt;li&gt;a &lt;code&gt;:node-script&lt;/code&gt; target in &lt;code&gt;shadow-cljs.edn&lt;/code&gt;, with &lt;code&gt;:main&lt;/code&gt; function specified&lt;/li&gt;
&lt;li&gt;a &lt;code&gt;release&lt;/code&gt; script in package.json, most probably &lt;code&gt;shadow-cljs release script&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;an entry script specified in &lt;code&gt;bin&lt;/code&gt; in package.json.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org02a848d" class="outline-2"&gt;
&lt;a href="#org02a848d"&gt;&lt;h2 id="org02a848d" class="cr-self-reference "&gt;Prefetch and generate lock file for dependencies&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-org02a848d"&gt;
&lt;p&gt;
During the &lt;i&gt;build&lt;/i&gt; phase of nix package, the process cannot perform any network request, as that will defeat the whole point of &lt;i&gt;determinism&lt;/i&gt;. The common practice is to use a &lt;i&gt;lock file&lt;/i&gt;. Which is essentially a recipe of all the necessary resources (and their checksums) for the building process. We can then prefetch all the resources into the nix store and tell the building process where to find the necessary resources during the actual building.
&lt;/p&gt;

&lt;p&gt;
On the npm side, we do it by running the following command. It will output a sha256 code, we save it for later.
&lt;/p&gt;

&lt;div class="org-src-container"&gt;
&lt;pre class="cr-highlighted"&gt;&lt;code class="lang-bash"&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;nix run nixpkgs#prefetch-npm-deps package-lock.json
&lt;/body&gt;&lt;/html&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;
On the Clojure side, we execute the following command. It will generate a &lt;code&gt;deps-lock.json&lt;/code&gt; file. We will refer it in the &lt;code&gt;flake.nix&lt;/code&gt;.
&lt;/p&gt;

&lt;div class="org-src-container"&gt;
&lt;pre class="cr-highlighted"&gt;&lt;code class="lang-bash"&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;nix run github:jlesquembre/clj-nix#deps-lock
&lt;/body&gt;&lt;/html&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org5a90764" class="outline-2"&gt;
&lt;a href="#org5a90764"&gt;&lt;h2 id="org5a90764" class="cr-self-reference "&gt;flake.nix&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-org5a90764"&gt;
&lt;blockquote&gt;
&lt;p&gt;
The following nix script takes heavy inspiration from &lt;a href="https://github.com/jlesquembre/clj-nix/issues/14#issuecomment-2661208232"&gt;this github issue comment&lt;/a&gt;.
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class="org-src-container"&gt;
&lt;pre class="cr-highlighted"&gt;&lt;code class="lang-nix"&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;{
  &lt;span class="hljs-attr"&gt;description&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;&amp;quot;&lt;/span&gt;;
  &lt;span class="hljs-attr"&gt;inputs.flake-utils.url&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;github:numtide/flake-utils&amp;quot;&lt;/span&gt;;
  &lt;span class="hljs-attr"&gt;inputs.nixpkgs.url&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;github:NixOS/nixpkgs/nixos-unstable&amp;quot;&lt;/span&gt;;
  &lt;span class="hljs-attr"&gt;inputs.clj-nix.url&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;github:jlesquembre/clj-nix&amp;quot;&lt;/span&gt;;
  &lt;span class="hljs-attr"&gt;outputs&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; { self, flake-utils, nixpkgs, clj-nix }:
    flake-utils.lib.eachDefaultSystem (&lt;span class="hljs-params"&gt;system:&lt;/span&gt;
      &lt;span class="hljs-keyword"&gt;let&lt;/span&gt;
        &lt;span class="hljs-attr"&gt;pkgs&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-built_in"&gt;import&lt;/span&gt; nixpkgs {
          &lt;span class="hljs-keyword"&gt;inherit&lt;/span&gt; system;
          &lt;span class="hljs-attr"&gt;overlays&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; [
            clj-nix.overlays.default
          ];
        };
      &lt;span class="hljs-keyword"&gt;in&lt;/span&gt; {
        &lt;span class="hljs-attr"&gt;packages.default&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; pkgs.buildNpmPackage &lt;span class="hljs-keyword"&gt;rec&lt;/span&gt; {
          &lt;span class="hljs-attr"&gt;pname&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;proj-name&amp;quot;&lt;/span&gt;;
          &lt;span class="hljs-attr"&gt;nativeBuildInputs&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; [ pkgs.babashka pkgs.clojure ];
          &lt;span class="hljs-attr"&gt;npmBuildScript&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;release&amp;quot;&lt;/span&gt;;
          &lt;span class="hljs-attr"&gt;version&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;0.0.1&amp;quot;&lt;/span&gt;;
          &lt;span class="hljs-attr"&gt;src&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;&lt;span class="hljs-subst"&gt;${self}&lt;/span&gt;&amp;quot;&lt;/span&gt;;
          &lt;span class="hljs-comment"&gt;# deps hash from previous prefetch-npm-deps&lt;/span&gt;
          &lt;span class="hljs-attr"&gt;npmDepsHash&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;sha256-0000=&amp;quot;&lt;/span&gt;;
          &lt;span class="hljs-comment"&gt;# deps-lock.json generated by github:jlesquembre/clj-nix#deps-lock&lt;/span&gt;
          &lt;span class="hljs-attr"&gt;deps-cache&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; pkgs.mk-deps-cache { &lt;span class="hljs-attr"&gt;lockfile&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-symbol"&gt;./deps-lock.json&lt;/span&gt;; };
          &lt;span class="hljs-attr"&gt;preBuild&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;''
            bb -e '(-&amp;gt; (slurp &amp;quot;deps.edn&amp;quot;)
                       rewrite-clj.zip/of-string
                       (rewrite-clj.zip/assoc :mvn/local-repo &amp;quot;&lt;span class="hljs-subst"&gt;${deps-cache}&lt;/span&gt;/.m2/repository&amp;quot;)
                       rewrite-clj.zip/root-string
                       (#(spit &amp;quot;deps.edn&amp;quot; %)))'
          ''&lt;/span&gt;;
        };
      }
    );
}
&lt;/body&gt;&lt;/html&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;
In the &lt;code&gt;preBuild&lt;/code&gt; script, we rewrite &lt;code&gt;deps.edn&lt;/code&gt; file to tell &lt;code&gt;clj&lt;/code&gt; to find dependencies in a local maven repo generated by &lt;code&gt;mk-deps-cache&lt;/code&gt;, which is provided by &lt;code&gt;clj-nix&lt;/code&gt; overlay. We then fill &lt;code&gt;npmDepsHash&lt;/code&gt; with the value we got from previous commands.
&lt;/p&gt;

&lt;p&gt;
With this &lt;code&gt;flake.nix&lt;/code&gt;, we can then build the project with &lt;code&gt;nix build .&lt;/code&gt; or run the script with &lt;code&gt;nix run .&lt;/code&gt;.
&lt;/p&gt;

&lt;p&gt;
You can check &lt;a href="https://github.com/imakira/espoir"&gt;this little project of mine&lt;/a&gt; for a working example.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org0fcbf0f" class="outline-2"&gt;
&lt;a href="#org0fcbf0f"&gt;&lt;h2 id="org0fcbf0f" class="cr-self-reference "&gt;&lt;span class="todo TODO"&gt;TODO&lt;/span&gt; Limitations&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-org0fcbf0f"&gt;
&lt;p&gt;
The hack in &lt;code&gt;preBuild&lt;/code&gt; only deals with dependencies pulled from maven repos. Git dependencies aren't probably handled.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry>
    <title type="html">Develop and Build a Common Lisp Project using Nix</title>
    <link href="https://coruscation.net/blogs/develop-and-build-a-common-lisp-project-using-nix.html"/>
    <updated>2025-10-27T17:31:20+08:00</updated>
    <id>https://coruscation.net/blogs/develop-and-build-a-common-lisp-project-using-nix.html</id>
    <content type="html">&lt;p&gt;
I recently tried to build a Common Lisp project using Nix and found it is quite easy with just the &lt;code&gt;buildASDFSystem&lt;/code&gt; function in nixpkgs and ASDF alone. I will share how I have done it here in case someone else finds it useful.
&lt;/p&gt;
&lt;div id="outline-container-org7daceda" class="outline-2"&gt;
&lt;a href="#org7daceda"&gt;&lt;h2 id="org7daceda" class="cr-self-reference "&gt;Simple Configuration When Developing&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-org7daceda"&gt;
&lt;p&gt;
On the Nix we will have something like this:
&lt;/p&gt;
&lt;div class="org-src-container"&gt;
&lt;pre class="cr-highlighted"&gt;&lt;code class="lang-nix"&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;span class="hljs-comment"&gt;# flake.nix&lt;/span&gt;
{
  &lt;span class="hljs-attr"&gt;description&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;&amp;quot;&lt;/span&gt;;
  &lt;span class="hljs-attr"&gt;inputs.flake-utils.url&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;github:numtide/flake-utils&amp;quot;&lt;/span&gt;;
  &lt;span class="hljs-attr"&gt;inputs.nixpkgs.url&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;github:NixOS/nixpkgs/nixos-unstable&amp;quot;&lt;/span&gt;;
  &lt;span class="hljs-attr"&gt;outputs&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; { self, flake-utils, nixpkgs }:
    flake-utils.lib.eachDefaultSystem (&lt;span class="hljs-params"&gt;system:&lt;/span&gt;
      &lt;span class="hljs-keyword"&gt;let&lt;/span&gt; pkgs &lt;span class="hljs-operator"&gt;=&lt;/span&gt; nixpkgs.legacyPackages.${system};
      &lt;span class="hljs-keyword"&gt;in&lt;/span&gt; &lt;span class="hljs-keyword"&gt;rec&lt;/span&gt; {
        &lt;span class="hljs-attr"&gt;packages.default&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; pkgs.sbcl.buildASDFSystem {
          &lt;span class="hljs-attr"&gt;pname&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;proj-name&amp;quot;&lt;/span&gt;;
          &lt;span class="hljs-attr"&gt;version&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;0.1&amp;quot;&lt;/span&gt;;
          &lt;span class="hljs-attr"&gt;src&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; self;
          &lt;span class="hljs-attr"&gt;lispLibs&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-keyword"&gt;with&lt;/span&gt; pkgs.sbclPackages; [
            alexandria
            &lt;span class="hljs-comment"&gt;# lisp packages in nixpkgs go here&lt;/span&gt;
          ];
          &lt;span class="hljs-attr"&gt;nativeLibs&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; [
            &lt;span class="hljs-comment"&gt;# native libs go here&lt;/span&gt;
          ];
        };
      }
    );
}
&lt;/body&gt;&lt;/html&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;
On the Lisp side we will have an &lt;code&gt;asd&lt;/code&gt; file
&lt;/p&gt;
&lt;div class="org-src-container"&gt;
&lt;pre class="cr-highlighted"&gt;&lt;code class="lang-lisp"&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;span class="hljs-comment"&gt;;; proj-name.asd&lt;/span&gt;
(&lt;span class="hljs-name"&gt;require&lt;/span&gt; 'asdf)
(&lt;span class="hljs-name"&gt;asdf&lt;/span&gt;&lt;span class="hljs-symbol"&gt;:defsystem&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;proj-name&amp;quot;&lt;/span&gt;
  &lt;span class="hljs-symbol"&gt;:depends-on&lt;/span&gt; (&lt;span class="hljs-name"&gt;#&lt;/span&gt;&lt;span class="hljs-symbol"&gt;:alexandria&lt;/span&gt;)
  &lt;span class="hljs-symbol"&gt;:components&lt;/span&gt; ((&lt;span class="hljs-symbol"&gt;:file&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;main&amp;quot;&lt;/span&gt;))) &lt;span class="hljs-comment"&gt;;; we will have a main.lisp file&lt;/span&gt;
&lt;/body&gt;&lt;/html&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;
With these two files we can then start developing the project with the following steps
&lt;/p&gt;

&lt;ul class="org-ul"&gt;
&lt;li&gt;Enter nix develop environment by executing &lt;code&gt;nix develop .&lt;/code&gt; in the directory the project.&lt;/li&gt;
&lt;li&gt;Launch Emacs inside the developing environment.&lt;/li&gt;
&lt;li&gt;Launch &lt;code&gt;sly&lt;/code&gt; (or &lt;code&gt;slime&lt;/code&gt;) in Emacs, and load the &lt;code&gt;asd&lt;/code&gt; file by &lt;code&gt;sly-compile-and-load-file&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Execute &lt;code&gt;(asdf:load-system &amp;quot;proj-name&amp;quot;)&lt;/code&gt; in the &lt;code&gt;sly&lt;/code&gt; repl.&lt;/li&gt;
&lt;li&gt;Enjoy!&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org73bfb1b" class="outline-2"&gt;
&lt;a href="#org73bfb1b"&gt;&lt;h2 id="org73bfb1b" class="cr-self-reference "&gt;Building an Executable&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-org73bfb1b"&gt;
&lt;p&gt;
To build an executable we need a few more snippets on the Nix side
&lt;/p&gt;

&lt;div class="org-src-container"&gt;
&lt;pre class="cr-highlighted"&gt;&lt;code class="lang-nix"&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;span class="hljs-comment"&gt;#...&lt;/span&gt;

&lt;span class="hljs-attr"&gt;packages.default&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; pkgs.sbcl.buildASDFSystem {
  &lt;span class="hljs-comment"&gt;# ...&lt;/span&gt;
  &lt;span class="hljs-comment"&gt;# other code is omitted here&lt;/span&gt;
  &lt;span class="hljs-attr"&gt;lispLibs&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; &lt;span class="hljs-keyword"&gt;with&lt;/span&gt; pkgs.sbclPackages; [
    alexandria
    &lt;span class="hljs-comment"&gt;# lisp packages in nixpkgs go here&lt;/span&gt;
  ];

  &lt;span class="hljs-attr"&gt;nativeBuildInputs&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; [
    pkgs.makeWrapper
  ];

  &lt;span class="hljs-attr"&gt;buildScript&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt; pkgs.writeText &lt;span class="hljs-string"&gt;&amp;quot;build-awesomes&amp;quot;&lt;/span&gt; &lt;span class="hljs-string"&gt;''
    (require 'asdf)
    (asdf:load-system &amp;quot;proj-name&amp;quot;)
    (sb-ext:save-lisp-and-die
                &amp;quot;proj-name&amp;quot;
                :executable t
                #+sb-core-compression :compression
                #+sb-core-compression t
                ;; assume we have the `main' function defined and exported in the main.lisp file
                :toplevel #'main:main) 
  ''&lt;/span&gt;;

  &lt;span class="hljs-attr"&gt;installPhase&lt;/span&gt; &lt;span class="hljs-operator"&gt;=&lt;/span&gt;   &lt;span class="hljs-string"&gt;''
    runHook preInstall
    mkdir -p $out/bin
    cp proj-name $out/bin

    # make sure the executable can find dynamically linked libraries
    wrapProgram $out/bin/proj-name \
                --prefix LD_LIBRARY_PATH : $LD_LIBRARY_PATH
    runHook postInstall
  ''&lt;/span&gt;;
};
&lt;/body&gt;&lt;/html&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;
When we execute &lt;code&gt;nix build .&lt;/code&gt; in the project directory, lisp scripts in &lt;code&gt;buildScript&lt;/code&gt; will be executed and generates a binary file &lt;code&gt;proj-name&lt;/code&gt;. The binary file will then be copied into &lt;code&gt;$out/bin&lt;/code&gt; directory by the scripts inside &lt;code&gt;installPhase&lt;/code&gt;. After the &lt;code&gt;nix build .&lt;/code&gt; finished, we can find the executable in the &lt;code&gt;result/bin/&lt;/code&gt; directory
&lt;/p&gt;

&lt;p&gt;
We can also use &lt;code&gt;nix run .&lt;/code&gt; to run the result executable directly.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org2f337f4" class="outline-2"&gt;
&lt;a href="#org2f337f4"&gt;&lt;h2 id="org2f337f4" class="cr-self-reference "&gt;Limitations of This Method and Other Notes&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-org2f337f4"&gt;
&lt;p&gt;
The biggest limitation of this solution may be you need to restart the REPL (or even the Emacs launched inside the develop environment) every time you add a package into the &lt;code&gt;flake.nix&lt;/code&gt;.
&lt;/p&gt;

&lt;p&gt;
You can find the lisp section of the nixpkgs documentation &lt;a href="https://nixos.org/manual/nixpkgs/stable/#lisp-overview"&gt;here&lt;/a&gt;. &lt;a href="https://github.com/NixOS/nixpkgs/blob/nixos-unstable/pkgs/development/lisp-modules/packages.nix"&gt;packages.nix&lt;/a&gt; in the nixpkgs also has plenty lisp project definitions we can take references from.
&lt;/p&gt;

&lt;p&gt;
I have a &lt;a href="https://github.com/imakira/awesomes"&gt;little project&lt;/a&gt; built this way and it runs on github actions simply by using &lt;code&gt;nix run .&lt;/code&gt;, you can also check that.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry>
    <title type="html">Demonstration</title>
    <link href="https://coruscation.net/blogs/demonstration.html"/>
    <updated>2025-10-27T15:43:05+08:00</updated>
    <id>https://coruscation.net/blogs/demonstration.html</id>
    <content type="html">&lt;div id="outline-container-orgcd1c615" class="outline-2"&gt;
&lt;a href="#orgcd1c615"&gt;&lt;h2 id="orgcd1c615" class="cr-self-reference "&gt;Code Blocks&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-orgcd1c615"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org318ea0c" class="outline-3"&gt;
&lt;a href="#org318ea0c"&gt;&lt;h3 id="org318ea0c" class="cr-self-reference "&gt;Inline Code Block&lt;/h3&gt;&lt;/a&gt;
&lt;div class="outline-text-3" id="text-org318ea0c"&gt;
&lt;p&gt;
Text around &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;(&lt;span class="hljs-name"&gt;uix.dom/create-root&lt;/span&gt; (&lt;span class="hljs-name"&gt;js/document.getElementById&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;root&amp;quot;&lt;/span&gt;))&lt;/body&gt;&lt;/html&gt; the inline code block.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org07b71fe" class="outline-3"&gt;
&lt;a href="#org07b71fe"&gt;&lt;h3 id="org07b71fe" class="cr-self-reference "&gt;Code Blocks&lt;/h3&gt;&lt;/a&gt;
&lt;div class="outline-text-3" id="text-org07b71fe"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Java&lt;/li&gt;
&lt;/ul&gt;

&lt;div class="org-src-container"&gt;
&lt;pre class="cr-highlighted"&gt;&lt;code class="lang-java"&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;span class="hljs-keyword"&gt;public&lt;/span&gt; &lt;span class="hljs-keyword"&gt;static&lt;/span&gt; &lt;span class="hljs-type"&gt;int&lt;/span&gt; &lt;span class="hljs-title function_"&gt;fib&lt;/span&gt;&lt;span class="hljs-params"&gt;(&lt;span class="hljs-type"&gt;int&lt;/span&gt; n)&lt;/span&gt; { 
    &lt;span class="hljs-keyword"&gt;if&lt;/span&gt; (n &amp;lt;= &lt;span class="hljs-number"&gt;1&lt;/span&gt;) {
        &lt;span class="hljs-keyword"&gt;return&lt;/span&gt; n;
    }
    &lt;span class="hljs-keyword"&gt;return&lt;/span&gt; fib(n - &lt;span class="hljs-number"&gt;1&lt;/span&gt;) + fib(n - &lt;span class="hljs-number"&gt;2&lt;/span&gt;);
}
&lt;/body&gt;&lt;/html&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul class="org-ul"&gt;
&lt;li&gt;Clojure&lt;/li&gt;
&lt;/ul&gt;

&lt;div class="org-src-container"&gt;
&lt;pre class="cr-highlighted"&gt;&lt;code class="lang-clojure"&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;(&lt;span class="hljs-name"&gt;defui&lt;/span&gt; app [{&lt;span class="hljs-symbol"&gt;:keys&lt;/span&gt; [initial-route]}]
  (&lt;span class="hljs-name"&gt;&lt;span class="hljs-built_in"&gt;let&lt;/span&gt;&lt;/span&gt; [[show-header? set-header!]
        (&lt;span class="hljs-name"&gt;use-state&lt;/span&gt;
         (&lt;span class="hljs-name"&gt;some&lt;/span&gt; #(&lt;span class="hljs-name"&gt;&lt;span class="hljs-built_in"&gt;=&lt;/span&gt;&lt;/span&gt; % initial-route)
               [&lt;span class="hljs-string"&gt;&amp;quot;/&amp;quot;&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;/home.html&amp;quot;&lt;/span&gt; &lt;span class="hljs-string"&gt;&amp;quot;/template.html&amp;quot;&lt;/span&gt;
                &lt;span class="hljs-string"&gt;&amp;quot;/index.html&amp;quot;&lt;/span&gt;]))]
    (&lt;span class="hljs-name"&gt;context-binding&lt;/span&gt; [*header-context* [show-header? set-header!]]
      ($ router/router {&lt;span class="hljs-symbol"&gt;:routes&lt;/span&gt; routes &lt;span class="hljs-symbol"&gt;:initial-route&lt;/span&gt; initial-route}
         ($ main {})))))
&lt;/body&gt;&lt;/html&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul class="org-ul"&gt;
&lt;li&gt;Emacs Lisp&lt;/li&gt;
&lt;/ul&gt;

&lt;div class="org-src-container"&gt;
&lt;pre class="cr-highlighted"&gt;&lt;code class="lang-emacs-lisp"&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;(&lt;span class="hljs-name"&gt;save-excursion&lt;/span&gt;                 
    (&lt;span class="hljs-name"&gt;goto-char&lt;/span&gt; (&lt;span class="hljs-name"&gt;point-min&lt;/span&gt;))    
&lt;/body&gt;&lt;/html&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgcaf5c80" class="outline-2"&gt;
&lt;a href="#orgcaf5c80"&gt;&lt;h2 id="orgcaf5c80" class="cr-self-reference "&gt;H2 Sample Text&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-orgcaf5c80"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org8046358" class="outline-3"&gt;
&lt;a href="#org8046358"&gt;&lt;h3 id="org8046358" class="cr-self-reference "&gt;H3 Sample Text Sample Text&lt;/h3&gt;&lt;/a&gt;
&lt;div class="outline-text-3" id="text-org8046358"&gt;
&lt;p&gt;
Some text in between
&lt;/p&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgbbb8530" class="outline-4"&gt;
&lt;a href="#orgbbb8530"&gt;&lt;h4 id="orgbbb8530" class="cr-self-reference "&gt;H4 Sample Text Sample Text&lt;/h4&gt;&lt;/a&gt;
&lt;div class="outline-text-4" id="text-orgbbb8530"&gt;
&lt;p&gt;
Some text in between
&lt;/p&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgd44d37f" class="outline-5"&gt;
&lt;a href="#orgd44d37f"&gt;&lt;h5 id="orgd44d37f" class="cr-self-reference "&gt;H5 Sample Text Sample Text&lt;/h5&gt;&lt;/a&gt;
&lt;div class="outline-text-5" id="text-orgd44d37f"&gt;
&lt;p&gt;
Some text in between
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org77c06c7" class="outline-2"&gt;
&lt;a href="#org77c06c7"&gt;&lt;h2 id="org77c06c7" class="cr-self-reference "&gt;Common Elements&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-org77c06c7"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;&lt;i&gt;italic&lt;/i&gt;&lt;/li&gt;
&lt;li&gt;&lt;b&gt;bold&lt;/b&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="underline"&gt;underline&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;verbatim&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;code&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;del&gt;strike-through&lt;/del&gt;&lt;/li&gt;
&lt;li&gt;Horizontal Rule&lt;/li&gt;
&lt;li&gt;&lt;code&gt;code&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org139abc3" class="outline-2"&gt;
&lt;a href="#org139abc3"&gt;&lt;h2 id="org139abc3" class="cr-self-reference "&gt;Other Elements&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-org139abc3"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org9dbcf58" class="outline-3"&gt;
&lt;a href="#org9dbcf58"&gt;&lt;h3 id="org9dbcf58" class="cr-self-reference "&gt;Table&lt;/h3&gt;&lt;/a&gt;
&lt;div class="outline-text-3" id="text-org9dbcf58"&gt;
&lt;table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides"&gt;


&lt;colgroup&gt;
&lt;col class="org-left"&gt;

&lt;col class="org-right"&gt;

&lt;col class="org-right"&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th scope="col" class="org-left"&gt;Name&lt;/th&gt;
&lt;th scope="col" class="org-right"&gt;Phone&lt;/th&gt;
&lt;th scope="col" class="org-right"&gt;Age&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td class="org-left"&gt;Peter&lt;/td&gt;
&lt;td class="org-right"&gt;1234&lt;/td&gt;
&lt;td class="org-right"&gt;17&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td class="org-left"&gt;Anna&lt;/td&gt;
&lt;td class="org-right"&gt;4321&lt;/td&gt;
&lt;td class="org-right"&gt;25&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgecfa848" class="outline-3"&gt;
&lt;a href="#orgecfa848"&gt;&lt;h3 id="orgecfa848" class="cr-self-reference "&gt;Reference&lt;/h3&gt;&lt;/a&gt;
&lt;div class="outline-text-3" id="text-orgecfa848"&gt;
&lt;blockquote&gt;
&lt;p&gt;
Everything should be made as simple as possible,
but not any simpler â€“ Albert Einstein
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgf13b081" class="outline-3"&gt;
&lt;a href="#orgf13b081"&gt;&lt;h3 id="orgf13b081" class="cr-self-reference "&gt;Unordered List&lt;/h3&gt;&lt;/a&gt;
&lt;div class="outline-text-3" id="text-orgf13b081"&gt;
&lt;ul class="org-ul"&gt;
&lt;li&gt;Item 1&lt;/li&gt;
&lt;li&gt;Item 2
&lt;ul class="org-ul"&gt;
&lt;li&gt;Level 2
&lt;ul class="org-ul"&gt;
&lt;li&gt;Level 3
&lt;ul class="org-ul"&gt;
&lt;li&gt;Level 4&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Another Mark&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Item 3&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgfd4a873" class="outline-5"&gt;
&lt;a href="#orgfd4a873"&gt;&lt;h5 id="orgfd4a873" class="cr-self-reference "&gt;Ordered List&lt;/h5&gt;&lt;/a&gt;
&lt;div class="outline-text-5" id="text-orgfd4a873"&gt;
&lt;ol class="org-ol"&gt;
&lt;li&gt;Item 1&lt;/li&gt;
&lt;li&gt;Item 2&lt;/li&gt;
&lt;li&gt;Item 3&lt;/li&gt;
&lt;li&gt;Item 4&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgf77cd90" class="outline-3"&gt;
&lt;a href="#orgf77cd90"&gt;&lt;h3 id="orgf77cd90" class="cr-self-reference "&gt;Description List&lt;/h3&gt;&lt;/a&gt;
&lt;div class="outline-text-3" id="text-orgf77cd90"&gt;
&lt;dl class="org-dl"&gt;
&lt;dt&gt;Name&lt;/dt&gt;&lt;dd&gt;Description
&lt;dl class="org-dl"&gt;
&lt;dt&gt;Nested&lt;/dt&gt;&lt;dd&gt;Nested Description&lt;/dd&gt;
&lt;/dl&gt;&lt;/dd&gt;
&lt;dt&gt;Name&lt;/dt&gt;&lt;dd&gt;Description&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgd1db550" class="outline-3"&gt;
&lt;a href="#orgd1db550"&gt;&lt;h3 id="orgd1db550" class="cr-self-reference "&gt;Sample Image&lt;/h3&gt;&lt;/a&gt;
&lt;div class="outline-text-3" id="text-orgd1db550"&gt;

&lt;div id="org5a107cc" class="figure"&gt;
&lt;p&gt;&lt;img width="550" height="368" src="imgs/1.jpg" alt="1.jpg"&gt;
&lt;/p&gt;
&lt;p&gt;&lt;span class="figure-number"&gt;Figure 1: &lt;/span&gt;This is an image&lt;/p&gt;
&lt;/div&gt;


&lt;div id="orgd46d811" class="figure"&gt;
&lt;p&gt;&lt;img width="550" height="368" src="imgs/1.webp" alt="1.webp"&gt;
&lt;/p&gt;
&lt;/div&gt;


&lt;div id="orgcc1329e" class="figure"&gt;
&lt;p&gt;&lt;img width="2624" height="3936" src="https://images.unsplash.com/photo-1746717410283-f4017128c38f?ixlib=rb-4.1.0&amp;amp;q=85&amp;amp;fm=jpg&amp;amp;crop=entropy&amp;amp;cs=srgb&amp;amp;dl=natalia-grela-sFINbLpdfqw-unsplash.jpg" alt="photo-1746717410283-f4017128c38f?ixlib=rb-4.1.0&amp;amp;q=85&amp;amp;fm=jpg&amp;amp;crop=entropy&amp;amp;cs=srgb&amp;amp;dl=natalia-grela-sFINbLpdfqw-unsplash.jpg"&gt;
&lt;/p&gt;
&lt;p&gt;&lt;span class="figure-number"&gt;Figure 2: &lt;/span&gt;sample high resolution vertical image&lt;/p&gt;
&lt;/div&gt;


&lt;div id="org4223b1f" class="figure"&gt;
&lt;p&gt;&lt;img width="4928" height="3280" src="https://images.unsplash.com/photo-1653384236127-c61634419fe0?ixlib=rb-4.1.0&amp;amp;q=85&amp;amp;fm=jpg&amp;amp;crop=entropy&amp;amp;cs=srgb&amp;amp;dl=johann-walter-bantz-Bp7hIvZnj9I-unsplash.jpg" alt="photo-1653384236127-c61634419fe0?ixlib=rb-4.1.0&amp;amp;q=85&amp;amp;fm=jpg&amp;amp;crop=entropy&amp;amp;cs=srgb&amp;amp;dl=johann-walter-bantz-Bp7hIvZnj9I-unsplash.jpg"&gt;
&lt;/p&gt;
&lt;p&gt;&lt;span class="figure-number"&gt;Figure 3: &lt;/span&gt;sample high resolution horizontal iamge&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-org1d55593" class="outline-2"&gt;
&lt;a href="#org1d55593"&gt;&lt;h2 id="org1d55593" class="cr-self-reference "&gt;Latex Test&lt;/h2&gt;&lt;/a&gt;
&lt;div class="outline-text-2" id="text-org1d55593"&gt;
&lt;/div&gt;
&lt;div id="outline-container-org14eb656" class="outline-3"&gt;
&lt;a href="#org14eb656"&gt;&lt;h3 id="org14eb656" class="cr-self-reference "&gt;Inline LaTeX&lt;/h3&gt;&lt;/a&gt;
&lt;div class="outline-text-3" id="text-org14eb656"&gt;
&lt;p&gt;
The magnitude &lt;img src="ltximg/demo_c309f6a7f999fb7c61cc3e705f2a9f768bc2c3ce.svg" alt="\(v\)" class="org-svg"&gt; is given by &lt;img src="ltximg/demo_18b830f2fdb20e199f786bc0b9fd93882fc68f16.svg" alt="\(||x|| = \sqrt{v^2_x + v^2_y + v^2_z}\)" class="org-svg"&gt; . Another way of writing this is &lt;img src="ltximg/demo_5789433fe00766ac710ddf86fc85054ba0dc5f86.svg" alt="\(d = \sqrt{x^2 + y^2 + z^2}\)" class="org-svg"&gt; where &lt;img src="ltximg/demo_ab3c489517742cf17ddaaf4a050e58455c76f327.svg" alt="\(x = v_x, y=v_y, z=v_z\)" class="org-svg"&gt;.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id="outline-container-orgb45c886" class="outline-3"&gt;
&lt;a href="#orgb45c886"&gt;&lt;h3 id="orgb45c886" class="cr-self-reference "&gt;Block LaTeX&lt;/h3&gt;&lt;/a&gt;
&lt;div class="outline-text-3" id="text-orgb45c886"&gt;

&lt;div class="equation-container"&gt;
&lt;span class="equation"&gt;
&lt;img src="ltximg/demo_ae291cc724486596fdc90ff15d6f43a08beec0aa.svg" alt="\begin{block*}
\mathrm{Fib}(n) =
\begin{cases}
    \ 0 &amp;amp;amp; \akif \ n=0, \\
    \ 1 &amp;amp;amp; \akif \  n=1, \\
    \ \mathrm{Fib}(n-1) + \mathrm{Fib}(n-2)  &amp;amp;amp; \mathrm{otherwise}.
\end{cases}
\end{block*}
" class="org-svg"&gt;
&lt;/span&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
</feed>
