{"version":3,"sources":["net/coruscation/cerulean/router.cljc"],"mappings":"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","names":["net.coruscation.cerulean.router/*router*","uix.core.create_context","props__41206__auto__","props134145","uix.core/glue-args","map__134163","cljs.core/--destructure-map","cljs.core.get","___41205__auto__","cljs.core.dissoc","f__41207__auto__","js/goog.DEBUG","temp__5825__auto__","net.coruscation.cerulean.router/router","f__41121__auto__","*current-component*-orig-val__134175","uix.core/*current-component*","*current-component*-temp-val__134176","cljs.core/map?","js/Error","uix.core/set-display-name","js/globalThis","js/globalThis.uix","js/globalThis.uix.dev","sig__41130__auto__","js/globalThis.uix.dev.signature!","js/globalThis.uix.dev.register!","routes","initial-route","children","vec__134165","cljs.core.nth","vec__134168","map__134171","map__134172","reitit-router","uix.hooks.alpha/use-memo","uix.hooks.alpha/use-clj-deps","args","reitit.core.router","route","set-route!","uix.core/use-state","or__5142__auto__","js/location.pathname","routing-state","set-routing-state!","old-routers","uix.core.use_ref","component","routing-data","reitit.core/match-by-path","uix.hooks.alpha.use_effect","history-listener","_","js/addEventListener","js/removeEventListener","cljs.core/reset!","cljs.core/deref","reitit.frontend.controllers/apply-controllers","cljs.core.update_in","data","cljs.core.merge","uix.compiler.alpha/component-element","uix.compiler.aot/>el","uix.compiler.aot/fragment","uix.compiler.attributes/interpret-attrs","props134184","map__134185","net.coruscation.cerulean.router/router-outlet","*current-component*-orig-val__134189","*current-component*-temp-val__134190","hook","map__134188","router-data","uix.core/use-context","uix.compiler.attributes/interpret-props","cljs.core.merge_with","cljs.core/into","net.coruscation.cerulean.router/navigate-to!","href","cljs.core/re-matches","js/window","js/history.pushState","js/undefined","js/dispatchEvent","js/PopStateEvent","props134200","map__134201","net.coruscation.cerulean.router/link","*current-component*-orig-val__134204","*current-component*-temp-val__134205","style","class","external?","onclick","e","cljs.core/not","uix.compiler.attributes.class_names","uix.compiler.attributes/convert-props","uix.compiler.attributes/keyword->string"],"sourcesContent":["(ns net.coruscation.cerulean.router\n  (:require\n   [uix.core :as uix :refer\n    [defui use-state use-ref use-effect use-memo $ #?@(:cljs [lazy suspense])]]\n   [reitit.core :as r]\n   [net.coruscation.cerulean.utils :as utils :refer [use-context]]\n   #?@(:cljs [[reitit.frontend.easy :as rfe]\n              [reitit.frontend.controllers :as rfc]])))\n\n\n(utils/defcontext *router* nil)\n\n(defui router [{:keys [routes initial-route children]}]\n  (let [reitit-router (use-memo (fn [& args]\n                                  (r/router routes))\n                                [routes])\n\n        [route set-route!] (use-state #?(:clj (or initial-route \"/index.html\")\n                                         :cljs (or initial-route js/location.pathname)))\n        [routing-state set-routing-state!] (use-state {})\n        old-routers (use-ref nil)\n\n        {{:keys [component ]} :data :as routing-data}\n        (use-memo (fn []\n                    (r/match-by-path reitit-router route))\n                  [reitit-router route])]\n    (use-effect\n     (fn []\n       #?(:cljs (let [history-listener (fn [_]\n                                         (set-route! js/location.pathname))]\n                  (js/addEventListener \"popstate\"\n                                       history-listener)\n                  (fn []\n                    (js/removeEventListener \"popstate\"\n                                            history-listener)))))\n     [])\n\n    (use-effect (fn []\n                  #?(:cljs\n                     (reset! old-routers\n                             (rfc/apply-controllers\n                              @old-routers\n                              (update-in routing-data [:data]\n                                         (fn [data]\n                                           (merge data {:routing-state routing-state\n                                                        :set-routing-state! set-routing-state!})))))))\n                [routing-data routing-state ])\n\n    (utils/context-binding\n        [*router* {:route route\n                   :set-route! set-route!\n                   :reitit-router reitit-router\n                   :routing-data routing-data\n                   :component component\n                   :routing-state routing-state\n                   :set-routing-state! set-routing-state!}]\n      ($ :<>\n         children))))\n\n\n(defui router-outlet [{:keys [hook]}]\n  (let [{:keys [component routing-data] :as router-data} (utils/use-context *router*)]\n    (when hook\n      (hook))\n    ($ component (merge-with into\n                             (-> routing-data :data :extra-data)\n                             routing-data))))\n\n(defn navigate-to! [href]\n  #?(:clj (throw (UnsupportedOperationException. \"Operation navigate-to! isn't supported in CLJ.\"))\n     :cljs (do\n             (if (re-matches #\"^https?://.*$\" href)\n               (set! (.. js/window -location -href)\n                     href)\n               (do (js/history.pushState js/undefined js/undefined href)\n                   (js/dispatchEvent (js/PopStateEvent. \"popstate\", js/undefined)))))))\n\n(defui link [{:keys [href children style class external?]}]\n  (let [onclick (fn [e]\n                  #?(:clj :default\n                     :cljs\n                     (do\n                       (when (not external?)\n                         (.preventDefault e)\n                         (navigate-to! href)))))]\n    ($ :a {:on-click onclick :style style :href href :class class}\n       children)))\n"]}