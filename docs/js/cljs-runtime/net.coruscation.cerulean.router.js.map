{"version":3,"sources":["net/coruscation/cerulean/router.cljc"],"mappings":"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","names":["net.coruscation.cerulean.router/*router*","uix.core.create_context","props__39433__auto__","props71723","uix.core/glue-args","map__71731","cljs.core/--destructure-map","cljs.core.get","___39432__auto__","cljs.core.dissoc","f__39434__auto__","js/goog.DEBUG","temp__5823__auto__","net.coruscation.cerulean.router/router","f__39348__auto__","*current-component*-orig-val__71761","uix.core/*current-component*","*current-component*-temp-val__71762","cljs.core/map?","js/Error","uix.core/set-display-name","js/globalThis","js/globalThis.uix","js/globalThis.uix.dev","sig__39357__auto__","js/globalThis.uix.dev.signature!","js/globalThis.uix.dev.register!","routes","initial-route","children","vec__71736","cljs.core.nth","vec__71739","map__71742","map__71743","reitit-router","uix.hooks.alpha/use-memo","uix.hooks.alpha/use-clj-deps","args","reitit.core.router","route","set-route!","uix.core/use-state","or__5141__auto__","js/location.pathname","routing-state","set-routing-state!","old-routers","uix.core.use_ref","component","routing-data","reitit.core/match-by-path","uix.hooks.alpha.use_effect","history-listener","_","js/addEventListener","js/removeEventListener","cljs.core/reset!","cljs.core/deref","reitit.frontend.controllers/apply-controllers","cljs.core.update_in","data","cljs.core.merge","uix.compiler.alpha/component-element","uix.compiler.aot/>el","uix.compiler.aot/fragment","uix.compiler.attributes/interpret-attrs","props71769","map__71770","net.coruscation.cerulean.router/router-outlet","*current-component*-orig-val__71774","*current-component*-temp-val__71775","hook","map__71773","router-data","uix.core/use-context","uix.compiler.attributes/interpret-props","cljs.core.merge_with","cljs.core/into","net.coruscation.cerulean.router/navigate-to!","href","cljs.core/re-matches","js/window","js/history.pushState","js/undefined","js/dispatchEvent","js/PopStateEvent","props71783","map__71784","net.coruscation.cerulean.router/link","*current-component*-orig-val__71787","*current-component*-temp-val__71788","style","class","external?","onclick","e","cljs.core/not","uix.compiler.attributes.class_names","uix.compiler.attributes/convert-props","uix.compiler.attributes/keyword->string"],"sourcesContent":["(ns net.coruscation.cerulean.router\n  (:require\n   [uix.core :as uix :refer\n    [defui use-state use-ref use-effect use-memo $ #?@(:cljs [lazy suspense])]]\n   [reitit.core :as r]\n   [net.coruscation.cerulean.utils :as utils :refer [use-context]]\n   #?@(:cljs [[reitit.frontend.easy :as rfe]\n              [reitit.frontend.controllers :as rfc]])))\n\n\n(utils/defcontext *router* nil)\n\n(defui router [{:keys [routes initial-route children]}]\n  (let [reitit-router (use-memo (fn [& args]\n                                  (r/router routes))\n                                [routes])\n\n        [route set-route!] (use-state #?(:clj (or initial-route \"/index.html\")\n                                         :cljs (or initial-route js/location.pathname)))\n        [routing-state set-routing-state!] (use-state {})\n        old-routers (use-ref nil)\n\n        {{:keys [component ]} :data :as routing-data}\n        (use-memo (fn []\n                    (r/match-by-path reitit-router route))\n                  [reitit-router route])]\n    (use-effect\n     (fn []\n       #?(:cljs (let [history-listener (fn [_]\n                                         (set-route! js/location.pathname))]\n                  (js/addEventListener \"popstate\"\n                                       history-listener)\n                  (fn []\n                    (js/removeEventListener \"popstate\"\n                                            history-listener)))))\n     [])\n\n    (use-effect (fn []\n                  #?(:cljs\n                     (reset! old-routers\n                             (rfc/apply-controllers\n                              @old-routers\n                              (update-in routing-data [:data]\n                                         (fn [data]\n                                           (merge data {:routing-state routing-state\n                                                        :set-routing-state! set-routing-state!})))))))\n                [routing-data routing-state ])\n\n    (utils/context-binding\n        [*router* {:route route\n                   :set-route! set-route!\n                   :reitit-router reitit-router\n                   :routing-data routing-data\n                   :component component\n                   :routing-state routing-state\n                   :set-routing-state! set-routing-state!}]\n      ($ :<>\n         children))))\n\n\n(defui router-outlet [{:keys [hook]}]\n  (let [{:keys [component routing-data] :as router-data} (utils/use-context *router*)]\n    (when hook\n      (hook))\n    ($ component (merge-with into\n                             (-> routing-data :data :extra-data)\n                             routing-data))))\n\n(defn navigate-to! [href]\n  #?(:clj (throw (UnsupportedOperationException. \"Operation navigate-to! isn't supported in CLJ.\"))\n     :cljs (do\n             (if (re-matches #\"^https?://.*$\" href)\n               (set! (.. js/window -location -href)\n                     href)\n               (do (js/history.pushState js/undefined js/undefined href)\n                   (js/dispatchEvent (js/PopStateEvent. \"popstate\", js/undefined)))))))\n\n(defui link [{:keys [href children style class external?]}]\n  (let [onclick (fn [e]\n                  #?(:clj :default\n                     :cljs\n                     (do\n                       (if (not external?)\n                         (do (.preventDefault e)\n                             (navigate-to! href))\n                         (set! (.. js/window -location -href)\n                               href)))))]\n    ($ :a {:on-click onclick :style style :href href :class class}\n       children)))\n"]}