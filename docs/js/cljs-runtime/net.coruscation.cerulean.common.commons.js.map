{"version":3,"sources":["net/coruscation/cerulean/common/commons.cljc"],"mappings":";;;;;;;;;AASA,mDAAA,nDAAMA,8GACHC,EAAEC;AADL,AAEE,OAACC,gBAAM,AAACA,gBAAM,AAACC,+CAAO,WAAAC;AAAA,AAAA,IAAAC,aAAAD;YAAA,AAAAE,4CAAAD,WAAA,IAAA,nEAAME;WAAN,AAAAD,4CAAAD,WAAA,IAAA,lEAAYG;AAAZ,AACE,QAACR,kCAAAA,wCAAAA,RAAEQ,oBAAAA;GACL,AAACC,oDAAYC,iBAAOT;;AAE5C,wDAAA,xDAAMU,wHAAeC;AAArB,AACE,OAACC,mEAAsBD,QAAQE;;AAEjC;;;;8DAAA,9DAAMC,oIAGHH;AAHH,AAIE,OAACI,gEACA,AAACC,gEACA,AAACC,8DAAiBN,QACA,mFAAA,nFAACO,wGACnB,2DAAA,IAAA,IAAA,nEAACC,yEACF,AAACC;;AAEJ;;;;;0DAAA,1DAAMC,4HAIHV;AAJH,AAKE,IAAA,AACE,OAACD,sDAAcC;gBADjB,GAAA,CAAAW,kBAGkBC;AAHlB,QAAAD,JAG4BE;AAH5B,AAII,IAAA,AAAK,OAACV,4DAAoBH;gBAA1B,GAAA,CAAAc,kBAEqBF;AAFrB,YAAAE,RAE+BD;AAF/B,AAGO,MAAO,gDAAA,4BAAA,2CAAA,vHAACE,qLACoBf;;AAJnC,AAAA,MAAAc;;;;AAJJ,AAAA,MAAAH;;;;AAUF,qDAAA,rDAAMK,kHAAYC;AAAlB,AACE,OAACC,sCAAuBD,IAAIf;;AAE9B,0DAAA,1DAAMiB,4HAAY/B;AAAlB,AACE,IAAMgC,MAAI,6CAAA,7CAACC;AAAX,AACE;mCAAOC;AAAP,AACE,IAAAC,qBAAW,eAAA,AAAAE,fAACC,+BAAMN,KAAIE;AAAtB,AAAA,oBAAAC;AAAA,QAAAA,JAASC;AAAT,AACE,OAACG,cAAIH;;AACL,AACE,IAAAD,yBAAW,eAAA,AAAAE,fAACC,+BAAMN,KAAIE;AAAtB,AAAA,oBAAAC;AAAA,QAAAA,JAASC;AAAT,AACE,OAACG,cAAIH;;AACL,IAAMI,MAAI,AAACC,8CAAMzC,EAAEkC;AAAnB,AACE,AAACQ,mDAAMV,IAAIW,gBAAMT,KAAKM;;AACtBA;;;;;IARHN;;;;EAAAA;;oCAAAA;;;IAAAA;0BAAAA","names":["net.coruscation.cerulean.common.commons/index-by","f","coll","cljs.core/first","cljs.core.filter","p__57463","vec__57464","cljs.core.nth","index","item","cljs.core.map_indexed","cljs.core/vector","net.coruscation.cerulean.common.commons/parse-iso8601","timestr","cljc.java_time.zoned_date_time.parse","cljc.java-time.format.date-time-formatter/iso-offset-date-time","net.coruscation.cerulean.common.commons/parse-org-timestamp","cljc.java_time.zoned_date_time.of","cljc.java_time.local_date_time.of","cljc.java_time.local_date.parse","cljc.java_time.format.date_time_formatter.of_pattern","cljc.java_time.local_time.of","cljc.java-time.zone-id/system-default","net.coruscation.cerulean.common.commons/parse-timestamp","e57467","js/Error","_","e57468","cljs.core.ex_info","net.coruscation.cerulean.common.commons/to-iso8601","zdt","cljc.java-time.zoned-date-time/format","net.coruscation.cerulean.common.commons/call-once!","mem","cljs.core.atom","args","temp__5823__auto__","e","cljs.core/deref","cljs.core/find","cljs.core/val","ret","cljs.core.apply","cljs.core.swap_BANG_","cljs.core/assoc"],"sourcesContent":["(ns net.coruscation.cerulean.common.commons\n  (:require\n   [cljc.java-time.format.date-time-formatter :as date-time-formatter]\n   [cljc.java-time.local-date :as local-date]\n   [cljc.java-time.local-date-time :as local-date-time]\n   [cljc.java-time.local-time :as local-time]\n   [cljc.java-time.zone-id :as zone-id]\n   [cljc.java-time.zoned-date-time :as zoned-date-time]))\n\n(defn index-by\n  [f coll]\n  (first (first (filter (fn [[index item]]\n                          (f item))\n                        (map-indexed vector coll)))))\n\n(defn parse-iso8601 [timestr]\n  (zoned-date-time/parse timestr date-time-formatter/iso-offset-date-time))\n\n(defn parse-org-timestamp\n  \"Parse org timestamp inserted with `org-timestamp`, example: <2026-01-24 Sat>\n  Throw an Exception if not supported\"\n  [timestr]\n  (zoned-date-time/of\n   (local-date-time/of\n    (local-date/parse timestr\n                      (date-time-formatter/of-pattern \"<yyyy-MM-dd EEE>\"))\n    (local-time/of 0 0 0))\n   (zone-id/system-default)))\n\n(defn parse-timestamp\n  \"Supporting two format:\n  1. org-mode timestamp inserted using `org-timestamp`, example: <2026-01-24 Sat>\n  2. iso8601 timestamp\"\n  [timestr]\n  (try\n    (parse-iso8601 timestr)\n    (catch #?(:clj java.lang.Throwable\n              :cljs js/Error) _\n      (try (parse-org-timestamp timestr)\n           (catch #?(:clj java.lang.Throwable\n                     :cljs js/Error) _\n             (throw (ex-info \"Can not parse timestamp: \"\n                             {:timestamp timestr})))))))\n\n(defn to-iso8601 [zdt]\n  (zoned-date-time/format zdt date-time-formatter/iso-offset-date-time))\n\n(defn call-once! [f]\n  (let [mem (atom {})]\n    (fn [& args]\n      (if-let [e (find @mem args)]\n        (val e)\n        (locking mem\n          (if-let [e (find @mem args)]\n            (val e)\n            (let [ret (apply f args)]\n              (swap! mem assoc args ret)\n              ret)))))))\n"]}