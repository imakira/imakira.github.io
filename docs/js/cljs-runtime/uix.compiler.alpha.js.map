{"version":3,"sources":["uix/compiler/alpha.cljs"],"mappings":"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","names":["uix.compiler.alpha/reagent-component?","component-type","js/Object","p1__75151#","cljs.core/some","clojure.string/starts-with?","uix.compiler.alpha/validate-component","and__5139__auto__","cljs.core/not","name-str","or__5141__auto__","js/Error","uix.compiler.alpha/normalise-args","js-props","props-children","uix.compiler.alpha/react-context?","x","js/Symbol","uix.compiler.alpha/pojo?","G__75182","uix.compiler.alpha/js-props?","tag","props","uix.compiler.alpha/create-element*","js/module$node_modules$react$index.createElement","uix.compiler.alpha/create-element","args","children","child","js/Object.assign","uix.compiler.alpha/uix-component-element","temp__5825__auto__","key","cljs.core.dissoc","uix.compiler.alpha/react-context-element","uix.compiler.alpha/react-component-element","uix.compiler.attributes/interpret-attrs","uix.compiler.alpha/dynamic-element","tag-id-class","uix.compiler.attributes/parse-tag","uix.compiler.alpha/component-element","js/goog.DEBUG","cljs.core/Keyword"],"sourcesContent":["(ns uix.compiler.alpha\n  (:require [react]\n            [uix.compiler.attributes :as attrs]\n            [clojure.string :as str]))\n\n(defn- reagent-component? [^js component-type]\n  (->> (.keys js/Object component-type)\n       (some #(when (str/starts-with? % \"G_\")\n                (identical? component-type (unchecked-get component-type %))))))\n\n(defn validate-component [^js component-type]\n  (when (and (not (.-uix-component? component-type))\n             (reagent-component? component-type))\n    (let [name-str (or (.-displayName component-type)\n                       (.-name component-type))]\n      (throw (js/Error. (str \"Invalid use of Reagent component \" name-str \" in `$` form.\\n\"\n                             \"UIx doesn't know how to render Reagent components.\\n\"\n                             \"Reagent element should be Hiccup wrapped with r/as-element, i.e. (r/as-element [\" name-str \"])\")))))\n  true)\n\n(defn- normalise-args [component-type js-props props-children]\n  (if (== 2 (.-length ^js props-children))\n    #js [component-type js-props (aget props-children 1)]\n    #js [component-type js-props]))\n\n(defn- react-context? [x]\n  (identical? (aget x \"$$typeof\")\n              (.for js/Symbol \"react.context\")))\n\n\n\n(defn- pojo? [x]\n  (and (not (.hasOwnProperty x \"$$typeof\"))\n       (some-> x .-constructor (identical? js/Object))))\n\n(defn- ^boolean js-props? [tag props]\n  (and (or (string? tag) (not (.-uix-component? ^js tag)))\n       props (pojo? props)))\n\n(def create-element* react/createElement)\n\n(defn ^js create-element [args children]\n  (let [tag (aget args 0)\n        props (aget args 1)\n        child (aget args 2)]\n    (if (js-props? tag child)\n      ;; merge dynamic js props onto static ones\n      (js* \"~{}(~{}, ~{}, ...~{})\" react/createElement tag (js/Object.assign props child) children)\n      (js* \"~{}(...~{}, ...~{})\" react/createElement args children))))\n\n(defn- uix-component-element [component-type ^js props-children children]\n  (let [props (aget props-children 0)\n        js-props (if-some [key (:key props)]\n                   #js {:key key :argv (dissoc props :key)}\n                   #js {:argv props})\n        args (normalise-args component-type js-props props-children)]\n    (create-element args children)))\n\n(defn- react-context-element [component-type ^js props-children children]\n  (let [component-type (.-Provider ^js component-type)\n        props (aget props-children 0)\n        js-props #js {:value (:value props)}\n        args (normalise-args component-type js-props props-children)]\n    (create-element args children)))\n\n(defn- react-component-element [component-type ^js props-children children]\n  (let [js-props (-> (aget props-children 0)\n                     (attrs/interpret-attrs #js [] true)\n                     (aget 0))\n        args (normalise-args component-type js-props props-children)]\n    (create-element args children)))\n\n(defn- dynamic-element [component-type ^js props-children children]\n  (let [tag-id-class (attrs/parse-tag component-type)\n        js-props (-> (aget props-children 0)\n                     (attrs/interpret-attrs tag-id-class false)\n                     (aget 0))\n        tag (aget tag-id-class 0)\n        args (normalise-args tag js-props props-children)]\n    (create-element args children)))\n\n(defn component-element [^clj component-type props-children children]\n  (when ^boolean goog.DEBUG\n    (validate-component component-type))\n  (cond\n    (.-uix-component? component-type)\n    (uix-component-element component-type props-children children)\n\n    (keyword? component-type)\n    (dynamic-element component-type props-children children)\n\n    (react-context? component-type)\n    (react-context-element component-type props-children children)\n\n    :else (react-component-element component-type props-children children)))\n"],"x_google_ignoreList":[0]}