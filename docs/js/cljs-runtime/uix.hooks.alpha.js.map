{"version":3,"sources":["uix/hooks/alpha.cljs"],"mappings":"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","names":["uix.hooks.alpha/choose-value","nv","cv","cljs.core._EQ_","uix.hooks.alpha/use-clojure-aware-updater","updater","js/module$node_modules$react$index.useCallback","v","args","G__70830","cljs.core/fn?","cljs.core.apply","uix.hooks.alpha/use-state","value","vec__70831","cljs.core.nth","state","set-state","js/module$node_modules$react$index.useState","uix.hooks.alpha/clojure-aware-reducer-updater","f","action","var_args","G__70839","uix.hooks.alpha/use-reducer","js/Error","js/module$node_modules$react$index.useReducer","init-state","uix.hooks.alpha/use-ref","js/module$node_modules$react$index.useRef","uix.hooks.alpha/with-return-value-check","ret","js/undefined","uix.hooks.alpha/use-clj-deps","deps","ref","cljs.core.not_EQ_","G__70851","uix.hooks.alpha/use-effect","setup-fn","js/module$node_modules$react$index.useEffect","G__70862","uix.hooks.alpha/use-layout-effect","js/module$node_modules$react$index.useLayoutEffect","G__70871","uix.hooks.alpha/use-insertion-effect","js/module$node_modules$react$index.useInsertionEffect","uix.hooks.alpha/use-callback","uix.hooks.alpha/use-memo","js/module$node_modules$react$index.useMemo","uix.hooks.alpha/use-context","js/module$node_modules$react$index.useContext","G__70884","uix.hooks.alpha/use-imperative-handle","create-handle","js/module$node_modules$react$index.useImperativeHandle","G__70888","uix.hooks.alpha/use-debug","uix.hooks.alpha.use_debug","fmt","js/module$node_modules$react$index.useDebugValue","G__70895","uix.hooks.alpha/use-deferred-value","js/module$node_modules$react$index.useDeferredValue","initial","uix.hooks.alpha/use-transition","js/module$node_modules$react$index.useTransition","uix.hooks.alpha/use-id","js/module$node_modules$react$index.useId","did-warn?","cljs.core/volatile!","snapshot-changed?","get-snapshot","e70908","e","uix.hooks.alpha/use-sync-external-store*","subscribe","get-server-snapshot","js/module$node_modules$react$index","js/module$node_modules$react$index.useSyncExternalStore","vec__70917","force-update","js/goog.DEBUG","cljs.core/deref","cached-value","cljs.core/vreset!","js/console.error","uix.hooks.alpha.use_layout_effect","G__70923","uix.hooks.alpha.use_effect","handle-store-change","G__70931","uix.hooks.alpha/use-sync-external-store-with-selector","selector","vec__70948","inst","or__5142__auto__","_","get-selection","get-server-selection","memo?","snapshot","selection","next-snapshot","cljs.core/not","next-selection","and__5140__auto__","prev-snapshot","prev-selection","get-snapshot-with-selector","get-server-snapshot-with-selector","G__70969","uix.hooks.alpha/use-sync-external-store","uix.hooks.alpha/use-optimistic","update-fn","js/module$node_modules$react$index.useOptimistic","G__70995","uix.hooks.alpha/use-action-state","js/module$node_modules$react$index.useActionState","permalink","uix.hooks.alpha/use","resource","js/module$node_modules$react$index.use","uix.hooks.alpha/use-batched-subscribe","listener","listeners","cljs.core.atom","cljs.core.swap_BANG_","cljs.core/conj","cljs.core/-add-watch","k","r","o","n","js/module$node_modules$scheduler$index.unstable_scheduleCallback","js/module$node_modules$scheduler$index.unstable_ImmediatePriority","seq__71010","cljs.core/seq","chunk__71011","count__71012","i__71013","temp__5825__auto__","cljs.core/chunked-seq?","c__5673__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","cljs.core/disj","cljs.core/empty?","cljs.core/-remove-watch"],"sourcesContent":["(ns uix.hooks.alpha\n  \"Wrappers for React Hooks\"\n  (:refer-clojure :exclude [use])\n  (:require [react :as r]\n            [scheduler]))\n\n(defn- choose-value [nv cv]\n  (if (= nv cv)\n    cv\n    nv))\n\n(defn- use-clojure-aware-updater\n  \"Replicates React's behaviour when updating state with identical JS value,\n  but using Clojure's value equality here\"\n  [updater]\n  (react/useCallback\n   (fn [v & args]\n     (updater\n      (fn [cv]\n        (if (fn? v)\n          (choose-value (apply v cv args) cv)\n          (choose-value v cv)))))\n   #js [updater]))\n\n;; == State hook ==\n\n(defn use-state [value]\n  (let [[state set-state] (r/useState value)\n        set-state (use-clojure-aware-updater set-state)]\n    #js [state set-state]))\n\n(defn- clojure-aware-reducer-updater\n  \"Same as `use-clojure-primitive-aware-updater` but for `use-reducer`\"\n  [f]\n  (fn [state action]\n    (choose-value (f state action) state)))\n\n(defn use-reducer\n  ([f value]\n   (let [updater (clojure-aware-reducer-updater f)]\n     (r/useReducer updater value)))\n  ([f value init-state]\n   (let [updater (clojure-aware-reducer-updater f)]\n     (r/useReducer updater value init-state))))\n\n;; == Ref hook\n\n(defn use-ref [value]\n  (r/useRef value))\n\n;; == Effect hook ==\n(defn with-return-value-check [f]\n  #(let [ret (f)]\n     (if (fn? ret) ret js/undefined)))\n\n(defn use-clj-deps [deps]\n  (let [ref (r/useRef deps)]\n    (when (not= (.-current ref) deps)\n      (set! (.-current ref) deps))\n    (.-current ref)))\n\n(defn use-effect\n  ([setup-fn]\n   (r/useEffect (with-return-value-check setup-fn)))\n  ([setup-fn deps]\n   (r/useEffect\n    (with-return-value-check setup-fn)\n    deps)))\n\n;; == Layout effect hook ==\n(defn use-layout-effect\n  ([setup-fn]\n   (r/useLayoutEffect\n    (with-return-value-check setup-fn)))\n  ([setup-fn deps]\n   (r/useLayoutEffect\n    (with-return-value-check setup-fn)\n    deps)))\n\n;; == Insertion effect hook ==\n(defn use-insertion-effect\n  ([f]\n   (r/useInsertionEffect\n    (with-return-value-check f)))\n  ([f deps]\n   (r/useInsertionEffect\n    (with-return-value-check f)\n    deps)))\n\n;; == Callback hook ==\n(defn use-callback\n  [f deps]\n  (r/useCallback f deps))\n\n;; == Memo hook ==\n(defn use-memo\n  [f deps]\n  (r/useMemo f deps))\n\n;; == Context hook ==\n(defn use-context [v]\n  (r/useContext v))\n\n;; == Imperative Handle hook ==\n(defn use-imperative-handle\n  ([ref create-handle]\n   (r/useImperativeHandle ref create-handle))\n  ([ref create-handle deps]\n   (r/useImperativeHandle ref create-handle deps)))\n\n;; == Debug hook ==\n(defn use-debug\n  ([v]\n   (use-debug v nil))\n  ([v fmt]\n   (r/useDebugValue v fmt)))\n\n(defn use-deferred-value\n  ([v]\n   (r/useDeferredValue (use-clj-deps v)))\n  ([v initial]\n   (r/useDeferredValue (use-clj-deps v) initial)))\n\n(defn use-transition []\n  (r/useTransition))\n\n(defn use-id []\n  (r/useId))\n\n(let [did-warn? (volatile! false)\n      snapshot-changed? (fn [value get-snapshot]\n                          (try\n                            (not= value (get-snapshot))\n                            (catch :default e\n                              true)))]\n\n  (defn- use-sync-external-store* [subscribe get-snapshot get-server-snapshot]\n    (if (exists? r/useSyncExternalStore)\n      (r/useSyncExternalStore subscribe get-snapshot get-server-snapshot)\n      (let [value (get-snapshot)\n            [^js state force-update] (use-state #js {:inst #js {:value value :getSnapshot get-snapshot}})]\n        (when ^boolean goog.DEBUG\n          (when-not @did-warn?\n            (let [cached-value (get-snapshot)]\n              (when-not (identical? cached-value value)\n                (vreset! did-warn? true)\n                (js/console.error \"The result of getSnapshot should be cached to avoid an infinite loop\")))))\n        (use-layout-effect\n          (fn []\n            (set! (.. state -inst -value) value)\n            (set! (.. state -inst -getSnapshot) get-snapshot)\n            (when (snapshot-changed? (.. state -inst -value) (.. state -inst -getSnapshot))\n              (force-update #js {:inst (.. state -inst)})))\n          [subscribe value get-snapshot])\n        (use-effect\n          (fn []\n            (let [handle-store-change #(when (snapshot-changed? (.. state -inst -value) (.. state -inst -getSnapshot))\n                                         (force-update #js {:inst (.. state -inst)}))]\n              (handle-store-change)\n              (subscribe handle-store-change)))\n          [subscribe])\n        (use-debug value)\n        value))))\n\n(defn use-sync-external-store-with-selector [subscribe get-snapshot get-server-snapshot selector]\n  (let [ref (use-ref nil)\n        inst (or (.-current ref) #js {:hasValue false :value nil})\n        _ (set! (.-current ref) inst)\n        [get-selection get-server-selection] (use-memo\n                                               (fn []\n                                                 (let [memo? (volatile! false)\n                                                       snapshot (volatile! nil)\n                                                       selection (volatile! nil)\n                                                       selector (fn [next-snapshot]\n                                                                  (if-not @memo?\n                                                                    (let [next-selection (selector next-snapshot)]\n                                                                      (vreset! memo? true)\n                                                                      (vreset! snapshot next-snapshot)\n                                                                      (if (and (.-hasValue inst) (= (.-value inst) next-selection))\n                                                                        (vreset! selection (.-value inst))\n                                                                        (vreset! selection next-selection)))\n                                                                    (let [prev-snapshot @snapshot\n                                                                          prev-selection @selection]\n                                                                      (if (= prev-snapshot next-snapshot)\n                                                                        prev-selection\n                                                                        (let [next-selection (selector next-snapshot)]\n                                                                          (if (= prev-selection next-selection)\n                                                                            (do (vreset! snapshot next-snapshot)\n                                                                                prev-selection)\n                                                                            (do (vreset! snapshot next-snapshot)\n                                                                                (vreset! selection next-selection))))))))\n                                                       get-snapshot-with-selector #(selector (get-snapshot))\n                                                       get-server-snapshot-with-selector (when get-server-snapshot\n                                                                                           #(selector (get-server-snapshot)))]\n                                                   [get-snapshot-with-selector get-server-snapshot-with-selector]))\n                                               #js [get-snapshot get-server-snapshot selector])\n        value (use-sync-external-store* subscribe get-selection get-server-selection)]\n    (use-effect\n      (fn []\n        (set! (.-hasValue inst) true)\n        (set! (.-value inst) value))\n      #js [value])\n    (use-debug value)\n    value))\n\n(defn use-sync-external-store\n  ([subscribe get-snapshot]\n   (use-sync-external-store* subscribe get-snapshot js/undefined))\n  ([subscribe get-snapshot get-server-snapshot]\n   (use-sync-external-store* subscribe get-snapshot get-server-snapshot))\n  ([subscribe get-snapshot get-server-snapshot selector]\n   (use-sync-external-store-with-selector subscribe get-snapshot get-server-snapshot selector)))\n\n(defn use-optimistic [state update-fn]\n  (r/useOptimistic state update-fn))\n\n(defn use-action-state\n  ([f state]\n   (react/useActionState f state))\n  ([f state permalink]\n   (react/useActionState f state permalink)))\n\n(defn use [resource]\n  (react/use resource))\n\n;;; ===========================\n\n(defn- use-batched-subscribe\n  \"Takes an atom-like ref type and returns a function\n  that adds change listeners to the ref\"\n  [^js ref]\n  (use-callback\n    (fn [listener]\n      ;; Adding an atom holding a set of listeners on a ref\n      (let [listeners (or (.-react-listeners ref) (atom #{}))]\n        (set! (.-react-listeners ref) listeners)\n        (swap! listeners conj listener)\n        (-add-watch ref ::listener\n          (fn [k r o n]\n            (when (not= o n)\n              (scheduler/unstable_scheduleCallback scheduler/unstable_ImmediatePriority\n                #(doseq [listener @listeners]\n                   (listener)))))))\n      (fn []\n        (let [listeners (.-react-listeners ref)]\n          (swap! listeners disj listener)\n          ;; When the last listener was removed,\n          ;; remove batched updates listener from the ref\n          (when (empty? @listeners)\n            (set! (.-react-listeners ref) nil)\n            (-remove-watch ref ::listener)))))\n    #js [ref]))"],"x_google_ignoreList":[0]}